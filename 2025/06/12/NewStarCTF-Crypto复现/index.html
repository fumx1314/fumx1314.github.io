
  <!DOCTYPE html>
  <html lang="zh-CN"  >
  <head>
  <meta charset="utf-8">
  

  

  

  <script>window.REIMU_CONFIG = {};window.REIMU_CONFIG.icon_font = '4552607_bq08450reo';window.REIMU_CONFIG.clipboard_tips = {"success":"复制成功(*^▽^*)","fail":"复制失败 (ﾟ⊿ﾟ)ﾂ","copyright":{"enable":false,"count":50,"content":"本文版权：本博客所有文章除特别声明外，均采用 BY-NC-SA 许可协议。转载请注明出处！"}};window.REIMU_CONFIG.code_block = {"expand":true};</script>
  
  <title>
    Crypto复现 |
    
    KL
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin><link rel="preload" as="style" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic&display=swap"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic&display=swap" media="print" onload="this.media&#x3D;&#39;all&#39;">
  
    <link rel="preload" href="//at.alicdn.com/t/c/font_4552607_bq08450reo.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  
  
    
<link rel="stylesheet" href="/css/loader.css">

  
  
    <meta name="description" content="week1  Base (16进制+base解密） 给了我们一串字符串 先16进制解密一次 再base32+base64解密一次  Strange King 123题目描述：某喜欢抽锐刻 5 的皇帝想每天进步一些，直到他娶了个模，回到原点，全部白给😅 这是他最后留下的讯息：&#96;ksjr&#123;EcxvpdErSvcDgdgEzxqjql&#125;&#96;，flag 包裹的是可读的明文 根据ksj">
<meta property="og:type" content="article">
<meta property="og:title" content="Crypto复现">
<meta property="og:url" content="http://example.com/2025/06/12/NewStarCTF-Crypto%E5%A4%8D%E7%8E%B0/index.html">
<meta property="og:site_name" content="KL">
<meta property="og:description" content="week1  Base (16进制+base解密） 给了我们一串字符串 先16进制解密一次 再base32+base64解密一次  Strange King 123题目描述：某喜欢抽锐刻 5 的皇帝想每天进步一些，直到他娶了个模，回到原点，全部白给😅 这是他最后留下的讯息：&#96;ksjr&#123;EcxvpdErSvcDgdgEzxqjql&#125;&#96;，flag 包裹的是可读的明文 根据ksj">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/2025/06/12/images/20250614173346792.png">
<meta property="og:image" content="http://example.com/2025/06/12/images/0250614185325016.png">
<meta property="og:image" content="http://example.com/2025/06/12/images/20250614185205407.png">
<meta property="og:image" content="http://example.com/2025/06/12/images/image-20250820222209554.png">
<meta property="og:image" content="http://example.com/2025/06/12/images/0250616180019625.png">
<meta property="og:image" content="http://example.com/2025/06/12/images/image-20250820231840050.png">
<meta property="og:image" content="http://example.com/2025/06/12/images/image-20250821002331849.png">
<meta property="og:image" content="http://example.com/2025/06/12/images/image-20250821004738926.png">
<meta property="og:image" content="http://example.com/2025/06/12/images/image-20250825204248328.png">
<meta property="og:image" content="http://example.com/2025/06/12/images/image-20250825202808414.png">
<meta property="og:image" content="http://example.com/2025/06/12/images/image-20250825205155824.png">
<meta property="og:image" content="http://example.com/2025/06/12/images/image-20250826162030399.png">
<meta property="og:image" content="http://example.com/2025/06/12/images/image-20250826161259164.png">
<meta property="og:image" content="http://example.com/2025/06/12/images/0509ef79d6b24826ab3593ce3e972ed7.png">
<meta property="og:image" content="http://example.com/2025/06/12/images/image-20250826211545264.png">
<meta property="og:image" content="http://example.com/2025/06/12/images/image-20250826221440757.png">
<meta property="article:published_time" content="2025-06-12T09:12:23.000Z">
<meta property="article:modified_time" content="2025-08-26T14:42:13.758Z">
<meta property="article:author" content="FuB0Y">
<meta property="article:tag" content="crypto">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2025/06/12/images/20250614173346792.png">
  
  
    <link rel="alternate" href="/atom.xml" title="KL" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/images/favicon.ico">
  
  
<link rel="stylesheet" href="/css/style.css">

  <link rel="preload" href="https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  
    
      
        
<link rel="stylesheet" href="https://npm.webcache.cn/katex@0.16.11/dist/katex.min.css">

      
    
  
  
  
  
    
<script src="https://npm.webcache.cn/pace-js@1.2.4/pace.min.js" integrity="sha384-k6YtvFUEIuEFBdrLKJ3YAUbBki333tj1CSUisai5Cswsg9wcLNaPzsTHDswp4Az8" crossorigin="anonymous"></script>

  
  
    
<link rel="stylesheet" href="https://npm.webcache.cn/@reimujs/aos@0.1.0/dist/aos.css">

  
  
<meta name="generator" content="Hexo 7.3.0"></head>

  <body>
    
  <div id='loader'>
    <div class="loading-left-bg loading-bg"></div>
    <div class="loading-right-bg loading-bg"></div>
    <div class="spinner-box">
      <div class="loading-taichi">
        
          <svg width="150" height="150" viewBox="0 0 1024 1024" class="icon" version="1.1" xmlns="https://www.w3.org/2000/svg" shape-rendering="geometricPrecision">
            <path d="M303.5 432A80 80 0 0 1 291.5 592A80 80 0 0 1 303.5 432z" fill="var(--red-1, #ff5252)" />
            <path d="M512 65A447 447 0 0 1 512 959L512 929A417 417 0 0 0 512 95A417 417 0 0 0 512 929L512 959A447 447 0 0 1 512 65z 
           M512 95A417 417 0 0 1 929 512A208.5 208.5 0 0 1 720.5 720.5L720.5 592A80 80 0 0 0 720.5 432A80 80 0 0 0 720.5 592L720.5 720.5A208.5 208.5 0 0 1 512 512A208.5 208.5 0 0 0 303.5 303.5A208.5 208.5 0 0 0 95 512A417 417 0 0 1 512 95z" fill="var(--red-1, #ff5252)" />
          </svg>
        
      </div>
      <div class="loading-word">少女祈祷中...</div>
    </div>
  </div>
  </div>
  <script>
    var time = null;
    var startLoading = () => {
      time = Date.now();
      document.getElementById('loader').classList.remove("loading");
    }
    var endLoading = () => {
      if (!time) {
        document.body.style.overflow = 'auto';
        document.getElementById('loader').classList.add("loading");
      } else {
        if (Date.now() - time > 500) {
          time = null;
          document.body.style.overflow = 'auto';
          document.getElementById('loader').classList.add("loading");
        } else {
          setTimeout(endLoading, 500 - (Date.now() - time));
          time = null;
        }
      }
    }
    window.addEventListener('DOMContentLoaded', endLoading);
    document.getElementById('loader').addEventListener('click', endLoading);
  </script>

<div id="copy-tooltip" style="pointer-events: none; opacity: 0; transition: all 0.2s ease; position: fixed;top: 50%;left: 50%;z-index: 999;transform: translate(-50%, -50%);color: white;background: rgba(0, 0, 0, 0.5);padding: 10px 15px;border-radius: 10px;">
</div>


    <div id="container">
      <div id="wrap">
        <div id="header-nav">
  <nav id="main-nav">
    
      
        <span class="main-nav-link-wrap">
          <div class="main-nav-icon icon rotate">
            &#xe62b;
          </div>
          <a class="main-nav-link" href="/">首页</a>
        </span>
      
        <span class="main-nav-link-wrap">
          <div class="main-nav-icon icon rotate">
            &#xe62b;
          </div>
          <a class="main-nav-link" href="/archives">归档</a>
        </span>
      
        <span class="main-nav-link-wrap">
          <div class="main-nav-icon icon rotate">
            &#xe62b;
          </div>
          <a class="main-nav-link" href="/about">关于</a>
        </span>
      
        <span class="main-nav-link-wrap">
          <div class="main-nav-icon icon rotate">
            &#xe62b;
          </div>
          <a class="main-nav-link" href="/friend">友链</a>
        </span>
      
    
    <a id="main-nav-toggle" class="nav-icon"></a>
  </nav>
  <nav id="sub-nav">
    
      <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅" target="_blank"></a>
    
    
    
  </nav>
</div>
<header id="header">
  
    <picture>
      
    </picture>
    
      <img fetchpriority="high" src="/images/banner.webp" alt="Crypto复现">
    
  
  <div id="header-outer">
    <div id="header-title">
      
        
        
          <a href="/" id="logo">
            <h1 data-aos="slide-up">Crypto复现</h1>
          </a>
        
      
      
        
        <h2 id="subtitle-wrap" data-aos="slide-down">
          
        </h2>
      
    </div>
  </div>
</header>

        <div id="content"  class="sidebar-right" >
          <aside id="sidebar">
  
  
  <div class="sidebar-wrapper wrap-sticky">
    <div class="sidebar-wrap" data-aos="fade-up">
      
        <div class="sidebar-toc-sidebar"><div class="sidebar-toc">
  <h3 class="toc-title">文章目录</h3>
  <div class="sidebar-toc-wrapper toc-div-class" >
      
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#week1"><span class="toc-number">1.</span> <span class="toc-text"> week1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#base-16%E8%BF%9B%E5%88%B6base%E8%A7%A3%E5%AF%86"><span class="toc-number">1.1.</span> <span class="toc-text"> Base (16进制+base解密）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#strange-king"><span class="toc-number">1.2.</span> <span class="toc-text"> Strange King</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#xor"><span class="toc-number">1.3.</span> <span class="toc-text"> xor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E7%9C%BC%E7%A7%92%E4%BA%86-rsa"><span class="toc-number">1.4.</span> <span class="toc-text"> 一眼秒了 （RSA）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week2"><span class="toc-number">2.</span> <span class="toc-text"> week2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#just-one-and-more-than-tworsa"><span class="toc-number">2.1.</span> <span class="toc-text"> Just one and more than two（RSA）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#since-you-konw-something%E5%BC%82%E6%88%96-%E7%88%86%E7%A0%B4"><span class="toc-number">2.2.</span> <span class="toc-text"> Since you konw something(异或 爆破)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8C%B6%E9%87%8C%E8%8C%B6%E6%B0%94tea%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95"><span class="toc-number">2.3.</span> <span class="toc-text"> 茶里茶气（TEA加密算法）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%99%E6%98%AF%E5%87%A0%E6%AC%A1%E6%96%B9%E7%96%91%E6%83%91"><span class="toc-number">2.4.</span> <span class="toc-text"> 这是几次方？疑惑！</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%95%E4%B8%80%E5%BC%82%E6%88%96%E7%AC%A6%E5%8F%B7%E7%9A%84%E8%BF%90%E7%AE%97%E4%BC%98%E5%85%88%E7%BA%A7"><span class="toc-number">2.4.1.</span> <span class="toc-text"> 法一：(异或符号的运算优先级)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%95%E4%BA%8Cfactor%E5%88%86%E8%A7%A3n"><span class="toc-number">2.4.2.</span> <span class="toc-text"> 法二：factor分解n</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week3"><span class="toc-number">3.</span> <span class="toc-text"> week3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E7%94%A8%E8%B0%A2%E5%96%B5aes%E7%9A%84cbc%E5%92%8Cecb%E6%A8%A1%E5%BC%8F"><span class="toc-number">3.1.</span> <span class="toc-text"> 不用谢喵（AES的CBC和ECB模式）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95"><span class="toc-number">3.1.1.</span> <span class="toc-text"> 加密算法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98"><span class="toc-number">3.1.2.</span> <span class="toc-text"> 解题</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%A4%E4%B8%AA%E9%BB%84%E9%B9%82%E9%B8%A3%E7%BF%A0%E6%9F%B3-%E5%85%B3%E8%81%94%E4%BF%A1%E6%81%AF%E6%94%BB%E5%87%BB-half-gcd%E7%AE%97%E6%B3%95"><span class="toc-number">3.2.</span> <span class="toc-text"> 两个黄鹂鸣翠柳 （关联信息攻击 Half-gcd算法）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%85%E4%BA%8B%E6%96%B0%E7%BC%96-1vigenere%E5%8A%A0%E5%AF%86"><span class="toc-number">3.3.</span> <span class="toc-text"> **故事新编 1(Vigenere加密) **</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%85%E4%BA%8B%E6%96%B0%E7%BC%96-2%E8%87%AA%E5%8A%A8%E5%AF%86%E9%92%A5%E5%8A%A0%E5%AF%86vigenere"><span class="toc-number">3.4.</span> <span class="toc-text"> 故事新编 2（自动密钥加密+Vigenere）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B2%A1e%E8%BF%99%E8%83%BD%E7%8E%A9%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0"><span class="toc-number">3.5.</span> <span class="toc-text"> 没e这能玩(离散对数)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week4"><span class="toc-number">4.</span> <span class="toc-text"> week4</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%B1%E4%BB%A5%E6%88%91%E4%B9%8B%E5%90%8D%E7%BB%B4%E7%BA%B3%E6%94%BB%E5%87%BB"><span class="toc-number">4.1.</span> <span class="toc-text"> 俱以我之名(维纳攻击)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86"><span class="toc-number">4.1.1.</span> <span class="toc-text"> 前置知识</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%B4%E7%BA%B3%E6%94%BB%E5%87%BB%E8%84%9A%E6%9C%ACsage"><span class="toc-number">4.1.2.</span> <span class="toc-text"> 维纳攻击脚本(sage)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98-2"><span class="toc-number">4.1.3.</span> <span class="toc-text"> 解题</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A3%E7%9F%B3%E5%8C%95%E9%A6%96"><span class="toc-number">4.2.</span> <span class="toc-text"> 圣石匕首</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AC%A7%E6%8B%89%E6%AC%A7%E6%8B%89%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%8A%A0%E6%B3%95%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0"><span class="toc-number">4.3.</span> <span class="toc-text"> 欧拉欧拉(二进制加法+欧拉函数)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week5"><span class="toc-number">5.</span> <span class="toc-text"> week5</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#rsa-cmd5rsa%E7%AD%BE%E5%90%8D"><span class="toc-number">5.1.</span> <span class="toc-text"> RSA? cmd5!（rsa签名）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easy_eccecc%E6%99%AE%E9%80%9A%E6%98%8E%E6%96%87%E6%98%A0%E5%B0%84%E5%8A%A0%E5%AF%86"><span class="toc-number">5.2.</span> <span class="toc-text"> easy_ecc（ECC普通明文映射加密）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%A6%E4%BB%A5%E8%87%B4%E7%94%A8%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%B1%82%E8%A7%A3"><span class="toc-number">5.3.</span> <span class="toc-text"> 学以致用(多项式求解)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B2%A1-e-%E4%B9%9F%E8%83%BD%E7%8E%A9dpdq%E6%B3%84%E9%9C%B2"><span class="toc-number">5.4.</span> <span class="toc-text"> 没 e 也能玩(dp,dq泄露)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%BC%E6%A0%BC%E4%BD%A0%E5%A5%BD%E6%A3%92%E6%A0%BC%E6%94%BB%E5%87%BB"><span class="toc-number">5.5.</span> <span class="toc-text"> 格格你好棒(格攻击)</span></a></li></ol></li></ol>
      
  </div>
</div>
</div>
        <div class="sidebar-common-sidebar hidden"><div class="sidebar-author">
  <img data-src="/avatar/avatar.jpg" data-sizes="auto" alt="FuB0Y" class="lazyload">
  <div class="sidebar-author-name">FuB0Y</div>
  <div class="sidebar-description">世所谓英雄者，不以挫抑而灰心，不以失败而退怯</div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>文章</div>
    <div class="sidebar-state-number">186</div>
  </div>
  <div class="sidebar-state-category">
    <div>分类</div>
    <div class="sidebar-state-number">4</div>
  </div>
  <div class="sidebar-state-tag">
    <div>标签</div>
    <div class="sidebar-state-number">179</div>
  </div>
</div>
<div class="sidebar-social">
  
</div>
<div class="sidebar-menu">
  
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/" aria-label="首页"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">首页</div>
      </div>
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/archives" aria-label="归档"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">归档</div>
      </div>
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/about" aria-label="关于"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">关于</div>
      </div>
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/friend" aria-label="友链"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">友链</div>
      </div>
    
  
</div>
</div>
      
      
        <div class="sidebar-btn-wrapper" style="position:static">
          <div class="sidebar-toc-btn current"></div>
          <div class="sidebar-common-btn"></div>
        </div>
      
    </div>
  </div>

  <div class="sidebar-widget">
  
  </div>
</aside>

          <section id="main"><article id="NewStarCTF Crypto复现-NewStarCTF-Crypto复现" class="h-entry article article-type-NewStarCTF Crypto复现" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner" data-aos="fade-up">
    <div class="article-meta">
      <div class="article-date">
  <a href="/2025/06/12/NewStarCTF-Crypto%E5%A4%8D%E7%8E%B0/" class="article-date-link" data-aos="zoom-in">
    <time datetime="2025-06-12T09:12:23.000Z" itemprop="datePublished">2025-06-12</time>
    <time style="display: none;" id="post-update-time">2025-08-26</time>
  </a>
</div>

      
  <div class="article-category">
    <a class="article-category-link" href="/categories/crypto/" data-aos="zoom-in">crypto</a>
  </div>


    </div>
    <div class="hr-line"></div>
    

    <div class="e-content article-entry" itemprop="articleBody">
      
      
        <h2 id="week1"><a class="markdownIt-Anchor" href="#week1"></a> week1</h2>
<h3 id="base-16进制base解密"><a class="markdownIt-Anchor" href="#base-16进制base解密"></a> Base (16进制+base解密）</h3>
<p>给了我们一串字符串</p>
<p>先16进制解密一次</p>
<p>再base32+base64解密一次</p>
<h3 id="strange-king"><a class="markdownIt-Anchor" href="#strange-king"></a> <strong>Strange King</strong></h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">题目描述：</span><br><span class="line"></span><br><span class="line">某喜欢抽锐刻 5 的皇帝想每天进步一些，直到他娶了个模，回到原点，全部白给😅 这是他最后留下的讯息：`ksjr&#123;EcxvpdErSvcDgdgEzxqjql&#125;`，flag 包裹的是可读的明文</span><br></pre></td></tr></table></figure>
<p>根据ksjr对应flag可以发现</p>
<p>f=k-5</p>
<p>l=s-7</p>
<p>…</p>
<p>对应偏移量5,7,9,11</p>
<p>而且需要%26</p>
<p>脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="string">&quot;ksjr&#123;EcxvpdErSvcDgdgEzxqjql&#125;&quot;</span></span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line">p=<span class="number">5</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    <span class="keyword">if</span> i.islower():</span><br><span class="line">        flag+=<span class="built_in">chr</span>(<span class="number">97</span>+(<span class="built_in">ord</span>(i)-p-<span class="number">97</span>)%<span class="number">26</span>)</span><br><span class="line">    <span class="keyword">elif</span> i.isupper():</span><br><span class="line">        flag+=<span class="built_in">chr</span>(<span class="number">65</span>+(<span class="built_in">ord</span>(i)-p-<span class="number">65</span>)%<span class="number">26</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        flag+=i</span><br><span class="line">    p+=<span class="number">2</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<h3 id="xor"><a class="markdownIt-Anchor" href="#xor"></a> <strong>xor</strong></h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#As a freshman starting in 2024, you should know something about XOR, so this task is for you to sign in.</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line"><span class="comment">#The Python pwntools library has a convenient xor() function that can XOR together data of different types and lengths</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"></span><br><span class="line">key = <span class="string">b&#x27;New_Star_CTF&#x27;</span></span><br><span class="line">flag=<span class="string">&#x27;flag&#123;*******************&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">m1 = bytes_to_long(<span class="built_in">bytes</span>(flag[:<span class="number">13</span>], encoding=<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">m2 = flag[<span class="number">13</span>:]</span><br><span class="line"></span><br><span class="line">c1 = m1 ^ bytes_to_long(key)</span><br><span class="line">c2 = xor(key, m2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c1=&#x27;</span>,c1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;c2=&#x27;</span>,c2)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c1= 8091799978721254458294926060841</span></span><br><span class="line"><span class="string">c2= b&#x27;;:\x1c1&lt;\x03&gt;*\x10\x11u;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>一个异或题</p>
<p>写逆脚本即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, long_to_bytes</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line">key = <span class="string">b&#x27;New_Star_CTF&#x27;</span></span><br><span class="line">c1= <span class="number">8091799978721254458294926060841</span></span><br><span class="line">c2= <span class="string">b&#x27;;:\x1c1&lt;\x03&gt;*\x10\x11u;&#x27;</span></span><br><span class="line">f2=xor(c2,key)</span><br><span class="line">f1=bytes_to_long(key)^c1</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(f1))</span><br><span class="line"><span class="built_in">print</span>(f2)</span><br></pre></td></tr></table></figure>
<h3 id="一眼秒了-rsa"><a class="markdownIt-Anchor" href="#一眼秒了-rsa"></a> 一眼秒了 （RSA）</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> serct <span class="keyword">import</span> flag</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = powmod(m, e, n)</span><br><span class="line"><span class="built_in">print</span>(n)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 52147017298260357180329101776864095134806848020663558064141648200366079331962132411967917697877875277103045755972006084078559453777291403087575061382674872573336431876500128247133861957730154418461680506403680189755399752882558438393107151815794295272358955300914752523377417192504702798450787430403387076153</span></span><br><span class="line"><span class="comment"># 48757373363225981717076130816529380470563968650367175499612268073517990636849798038662283440350470812898424299904371831068541394247432423751879457624606194334196130444478878533092854342610288522236409554286954091860638388043037601371807379269588474814290382239910358697485110591812060488786552463208464541069</span></span><br></pre></td></tr></table></figure>
<p>已知n,c,e</p>
<p>n分解为p,q</p>
<p>用p,q,e进行<code>d=insert(e,(p-1)*(q-1)</code>求出d</p>
<p>然后<code>m=powmod(c,d,n)</code></p>
<h2 id="week2"><a class="markdownIt-Anchor" href="#week2"></a> week2</h2>
<h3 id="just-one-and-more-than-tworsa"><a class="markdownIt-Anchor" href="#just-one-and-more-than-tworsa"></a> <strong>Just one and more than two（RSA）</strong></h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;?????&#125;&#x27;</span></span><br><span class="line">m1 = bytes_to_long(flag[:<span class="built_in">len</span>(flag)//<span class="number">2</span>])</span><br><span class="line">m2 = bytes_to_long(flag[<span class="built_in">len</span>(flag)//<span class="number">2</span>:])</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p, q, r= (getPrime(<span class="number">512</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>))</span><br><span class="line">N=p*q*r</span><br><span class="line">c1 = <span class="built_in">pow</span>(m1, e, p)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m2, e, N)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;p=<span class="subst">&#123;p&#125;</span>\nq=<span class="subst">&#123;q&#125;</span>\nr=<span class="subst">&#123;r&#125;</span>\nc1=<span class="subst">&#123;c1&#125;</span>\nc2=<span class="subst">&#123;c2&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p=11867061353246233251584761575576071264056514705066766922825303434965272105673287382545586304271607224747442087588050625742380204503331976589883604074235133</span></span><br><span class="line"><span class="string">q=11873178589368883675890917699819207736397010385081364225879431054112944129299850257938753554259645705535337054802699202512825107090843889676443867510412393</span></span><br><span class="line"><span class="string">r=12897499208983423232868869100223973634537663127759671894357936868650239679942565058234189535395732577137079689110541612150759420022709417457551292448732371</span></span><br><span class="line"><span class="string">c1=8705739659634329013157482960027934795454950884941966136315983526808527784650002967954059125075894300750418062742140200130188545338806355927273170470295451</span></span><br><span class="line"><span class="string">c2=1004454248332792626131205259568148422136121342421144637194771487691844257449866491626726822289975189661332527496380578001514976911349965774838476334431923162269315555654716024616432373992288127966016197043606785386738961886826177232627159894038652924267065612922880048963182518107479487219900530746076603182269336917003411508524223257315597473638623530380492690984112891827897831400759409394315311767776323920195436460284244090970865474530727893555217020636612445</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>这个也算变种求d</p>
<p>只不过不是(p-1)*(q-1)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">d1=invert(e,p-1)</span><br><span class="line"></span><br><span class="line">d2=invert(e,(p-1)*(q-1)*(r-1))</span><br></pre></td></tr></table></figure>
<p>然后求c即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">p=<span class="number">11867061353246233251584761575576071264056514705066766922825303434965272105673287382545586304271607224747442087588050625742380204503331976589883604074235133</span></span><br><span class="line">q=<span class="number">11873178589368883675890917699819207736397010385081364225879431054112944129299850257938753554259645705535337054802699202512825107090843889676443867510412393</span></span><br><span class="line">r=<span class="number">12897499208983423232868869100223973634537663127759671894357936868650239679942565058234189535395732577137079689110541612150759420022709417457551292448732371</span></span><br><span class="line">c1=<span class="number">8705739659634329013157482960027934795454950884941966136315983526808527784650002967954059125075894300750418062742140200130188545338806355927273170470295451</span></span><br><span class="line">c2=<span class="number">1004454248332792626131205259568148422136121342421144637194771487691844257449866491626726822289975189661332527496380578001514976911349965774838476334431923162269315555654716024616432373992288127966016197043606785386738961886826177232627159894038652924267065612922880048963182518107479487219900530746076603182269336917003411508524223257315597473638623530380492690984112891827897831400759409394315311767776323920195436460284244090970865474530727893555217020636612445</span></span><br><span class="line">d1=gmpy2.invert(e,p-<span class="number">1</span>)</span><br><span class="line">d2=gmpy2.invert(e,(p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>))</span><br><span class="line">f1=gmpy2.powmod(c1,d1,p)</span><br><span class="line">f2=gmpy2.powmod(c2,d2,p*q*r)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(f1)+long_to_bytes(f2))</span><br></pre></td></tr></table></figure>
<h3 id="since-you-konw-something异或-爆破"><a class="markdownIt-Anchor" href="#since-you-konw-something异或-爆破"></a> <strong>Since you konw something(异或 爆破)</strong></h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line"><span class="comment">#The Python pwntools library has a convenient xor() function that can XOR together data of different types and lengths</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long</span><br><span class="line"></span><br><span class="line">key = ?? <span class="comment">#extremely short</span></span><br><span class="line">FLAG = <span class="string">&#x27;flag&#123;????????&#125;&#x27;</span></span><br><span class="line">c = bytes_to_long(xor(FLAG,key))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c=&#123;&#125;&quot;</span>.<span class="built_in">format</span>(c))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c=218950457292639210021937048771508243745941011391746420225459726647571</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>题目说key是很短的两位</p>
<p>我们直接爆破：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> xor</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, long_to_bytes</span><br><span class="line"></span><br><span class="line">c=long_to_bytes(<span class="number">218950457292639210021937048771508243745941011391746420225459726647571</span>)</span><br><span class="line">a=<span class="string">&quot;abcdefghijklmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ1234567890&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> a:</span><br><span class="line">        key=i+j</span><br><span class="line">        flag=xor(key,c)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;flag =&quot;</span>,flag)</span><br></pre></td></tr></table></figure>
<h3 id="茶里茶气tea加密算法"><a class="markdownIt-Anchor" href="#茶里茶气tea加密算法"></a> <strong>茶里茶气（TEA加密算法）</strong></h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&quot;flag&#123;*****&#125;&quot;</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>( flag ) == <span class="number">25</span></span><br><span class="line"></span><br><span class="line">a = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> flag:</span><br><span class="line">    a += <span class="built_in">hex</span>(<span class="built_in">ord</span>(i))[<span class="number">2</span>:]</span><br><span class="line">l = <span class="built_in">int</span>(a,<span class="number">16</span>).bit_length()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;l  =&quot;</span> , l )</span><br><span class="line"></span><br><span class="line">v0 = <span class="built_in">int</span>(a,<span class="number">16</span>)&gt;&gt;(l//<span class="number">2</span>)</span><br><span class="line">v1 = <span class="built_in">int</span>(a,<span class="number">16</span>)-(v0&lt;&lt;(l//<span class="number">2</span>))</span><br><span class="line">p = getPrime(l//<span class="number">2</span>+<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">v2 = <span class="number">0</span></span><br><span class="line">derta = <span class="number">462861781278454071588539315363</span></span><br><span class="line">v3 = <span class="number">489552116384728571199414424951</span></span><br><span class="line">v4 = <span class="number">469728069391226765421086670817</span></span><br><span class="line">v5 = <span class="number">564098252372959621721124077407</span></span><br><span class="line">v6 = <span class="number">335640247620454039831329381071</span></span><br><span class="line"><span class="keyword">assert</span> v1 &lt; p <span class="keyword">and</span> v0 &lt; p <span class="keyword">and</span> derta &lt; p <span class="keyword">and</span> v3 &lt; p <span class="keyword">and</span> v4 &lt; p <span class="keyword">and</span> v5 &lt; p <span class="keyword">and</span> v6 &lt; p </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    v1 += (v0+v2) ^ ( <span class="number">8</span>*v0 + v3 ) ^ ( (v0&gt;&gt;<span class="number">7</span>) + v4 ) ; v1 %= p</span><br><span class="line">    v0 += (v1+v2) ^ ( <span class="number">8</span>*v1 + v5 ) ^ ( (v1&gt;&gt;<span class="number">7</span>) + v6 ) ; v0 %= p</span><br><span class="line">    v2 += derta ; v2 %= p</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>( <span class="string">&quot;p  =&quot;</span> , p  )</span><br><span class="line"><span class="built_in">print</span>( <span class="string">&quot;v0 =&quot;</span> , v0 )</span><br><span class="line"><span class="built_in">print</span>( <span class="string">&quot;v1 =&quot;</span> , v1 )</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">l  = 199</span></span><br><span class="line"><span class="string">p  = 446302455051275584229157195942211</span></span><br><span class="line"><span class="string">v0 = 190997821330413928409069858571234</span></span><br><span class="line"><span class="string">v1 = 137340509740671759939138452113480</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p><strong>tea加密算法：</strong></p>
<p>te<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=a%E7%AE%97%E6%B3%95&amp;spm=1001.2101.3001.7020">a算法</a>的主要特征表现在sum和delta变量，以及3行核心加密中出现的右移4左移5，两行各有3个小括号互相异或</p>
<p>在题目中看到这些特征时就应该警醒这是tea<a target="_blank" rel="noopener" href="https://so.csdn.net/so/search?q=%E7%9B%B8%E5%85%B3%E7%AE%97%E6%B3%95&amp;spm=1001.2101.3001.7020">相关算法</a></p>
<p>其实解这方面的题目主要就是<strong>逆向解密</strong></p>
<p><strong>解题：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">flag = &quot;flag&#123;*****&#125;&quot;</span><br><span class="line">assert len( flag ) == 25</span><br><span class="line"> </span><br><span class="line">a = &quot;&quot;</span><br><span class="line">for i in flag:</span><br><span class="line">    a += hex(ord(i))[2:]</span><br><span class="line">l = int(a,16).bit_length()</span><br><span class="line">print(&quot;l  =&quot; , l )</span><br><span class="line">#并没有改变数据本身，只是把移位的结构存下来，所以根据二式可以复原结果</span><br><span class="line">v0 = int(a,16)&gt;&gt;(l//2)  # 取高 l//2 位</span><br><span class="line">v1 = int(a,16)-(v0&lt;&lt;(l//2))  # 取低 l//2 位</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p><code>ord(i)</code> 获取字符的 ASCII 码（如 <code>'f'</code> → <code>102</code>）。</p>
</li>
<li>
<p><code>hex(ord(i))[2:]</code> 去掉 <code>0x</code> 前缀，保留 2 位十六进制（如 <code>102</code> → <code>'66'</code>）。</p>
</li>
<li>
<p><strong>最终 <code>a</code> 是一个 50 位的十六进制字符串</strong>（因为 25 字节 × 2 字符/字节 = 50 字符）。</p>
</li>
<li>
<p><code>int(a, 16)</code> 把十六进制字符串 <code>a</code> 转为一个大整数。</p>
</li>
<li>
<p><code>bit_length()</code> 计算该整数的二进制位数 <code>l</code>（比如 50 位十六进制 → 约 200 位二进制）。</p>
</li>
</ul>
<p>v0是将a进行右移位运算得到，而v1由a和v0共同得到，在这里可以推出通过v1和v0还原a的式子</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=hex((v0&lt;&lt;(l//2))+v1)[2:]</span><br></pre></td></tr></table></figure>
<p>接下来是tea的加密部分</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">assert</span> v1 &lt; p <span class="keyword">and</span> v0 &lt; p <span class="keyword">and</span> derta &lt; p <span class="keyword">and</span> v3 &lt; p <span class="keyword">and</span> v4 &lt; p <span class="keyword">and</span> v5 &lt; p <span class="keyword">and</span> v6 &lt; p </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    v1 += (v0+v2) ^ ( <span class="number">8</span>*v0 + v3 ) ^ ( (v0&gt;&gt;<span class="number">7</span>) + v4 ) ; v1 %= p</span><br><span class="line">    v0 += (v1+v2) ^ ( <span class="number">8</span>*v1 + v5 ) ^ ( (v1&gt;&gt;<span class="number">7</span>) + v6 ) ; v0 %= p</span><br><span class="line">    v2 += derta ; v2 %= p</span><br></pre></td></tr></table></figure>
<p>可以看到除了V2是每一次都有增加一个derta值外，V1和V0每次都是异或操作，那就顺着异或回去不就行了，这也是tea的简单特性</p>
<p>所以，先执行一次循环，求出V2，再倒着异或解密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    v2+=derta;v2%=p</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    v2-=derta;v2%=p</span><br><span class="line">    v0 -= (v1 + v2) ^ (<span class="number">8</span> * v1 + v5) ^ ((v1 &gt;&gt; <span class="number">7</span>) + v6); v0 %= p</span><br><span class="line">    v1 -= (v0 + v2) ^ (<span class="number">8</span> * v0 + v3) ^ ((v0 &gt;&gt; <span class="number">7</span>) + v4); v1 %= p</span><br></pre></td></tr></table></figure>
<p>所以我们的总解密思路：逆运算求原v0,v1，然后通过v0,v1求出a</p>
<p>解密脚本：</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> string <span class="keyword">import</span> *</span><br><span class="line">v2 = <span class="number">0</span></span><br><span class="line">derta = <span class="number">462861781278454071588539315363</span></span><br><span class="line">v3 = <span class="number">489552116384728571199414424951</span></span><br><span class="line">v4 = <span class="number">469728069391226765421086670817</span></span><br><span class="line">v5 = <span class="number">564098252372959621721124077407</span></span><br><span class="line">v6 = <span class="number">335640247620454039831329381071</span></span><br><span class="line">l  = <span class="number">199</span></span><br><span class="line">p  = <span class="number">446302455051275584229157195942211</span></span><br><span class="line">v0 = <span class="number">190997821330413928409069858571234</span></span><br><span class="line">v1 = <span class="number">137340509740671759939138452113480</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#求原v0,v1</span></span><br><span class="line"><span class="comment">#先算出后v2</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    v2+=derta</span><br><span class="line">    v2 %= p</span><br><span class="line"><span class="comment">#求v1,v0</span></span><br><span class="line"><span class="comment"># v1 += (v0+v2) ^ ( 8*v0 + v3 ) ^ ( (v0&gt;&gt;7) + v4 ) ; v1 %= p</span></span><br><span class="line"><span class="comment"># v0 += (v1+v2) ^ ( 8*v1 + v5 ) ^ ( (v1&gt;&gt;7) + v6 ) ; v0 %= p</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">    <span class="comment">#先v0再v1</span></span><br><span class="line">    v2 -= derta</span><br><span class="line">    v2 %= p</span><br><span class="line">    v0-=(v1+v2) ^ ( <span class="number">8</span>*v1 + v5 ) ^ ( (v1&gt;&gt;<span class="number">7</span>) + v6 ) ; v0 %= p</span><br><span class="line">    v1-=(v0+v2) ^ ( <span class="number">8</span>*v0 + v3 ) ^ ( (v0&gt;&gt;<span class="number">7</span>) + v4 ) ; v1 %= p</span><br><span class="line">a=<span class="built_in">hex</span>((v0&lt;&lt;(l//<span class="number">2</span>))+v1)[<span class="number">2</span>:]</span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(a),<span class="number">2</span>):</span><br><span class="line">    flag += <span class="built_in">chr</span>(<span class="built_in">int</span>(a[i] + a[i + <span class="number">1</span>], <span class="number">16</span>))</span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="这是几次方疑惑"><a class="markdownIt-Anchor" href="#这是几次方疑惑"></a> <strong>这是几次方？疑惑！</strong></h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;*****&#125;&#x27;</span></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line">hint = p^e + <span class="number">10086</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>, c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[n, e] =&quot;</span>, [n, e])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;hint =&quot;</span>, hint)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 36513006092776816463005807690891878445084897511693065366878424579653926750135820835708001956534802873403195178517427725389634058598049226914694122804888321427912070308432512908833529417531492965615348806470164107231108504308584954154513331333004804817854315094324454847081460199485733298227480134551273155762</span></span><br><span class="line"><span class="string">[n, e] = [124455847177872829086850368685666872009698526875425204001499218854100257535484730033567552600005229013042351828575037023159889870271253559515001300645102569745482135768148755333759957370341658601268473878114399708702841974488367343570414404038862892863275173656133199924484523427712604601606674219929087411261, 65537]</span></span><br><span class="line"><span class="string">hint = 12578819356802034679792891975754306960297043516674290901441811200649679289740456805726985390445432800908006773857670255951581884098015799603908242531673390</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<h4 id="法一异或符号的运算优先级"><a class="markdownIt-Anchor" href="#法一异或符号的运算优先级"></a> 法一：(异或符号的运算优先级)</h4>
<p>这道题需要清楚<strong>异或操作的优先级是低于乘除加减</strong>的，所以 <strong>hint 是 p 和 e+10086 的异或结果</strong>，这样就可以得到 p</p>
<p>然后用n整除p得到q</p>
<p>进行rsa解密</p>
<h4 id="法二factor分解n"><a class="markdownIt-Anchor" href="#法二factor分解n"></a> 法二：factor分解n</h4>
<p>factordb里面收录了该n的分解</p>
<p>可以直接分解n得到q,p</p>
<p>进行rsa解密</p>
<h2 id="week3"><a class="markdownIt-Anchor" href="#week3"></a> week3</h2>
<h3 id="不用谢喵aes的cbc和ecb模式"><a class="markdownIt-Anchor" href="#不用谢喵aes的cbc和ecb模式"></a> <strong>不用谢喵（AES的CBC和ECB模式）</strong></h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">KEY = <span class="string">b&quot;fake_key_fake_ke&quot;</span></span><br><span class="line">FLAG = <span class="string">&quot;flag&#123;fake_flag_fake_flag&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">c</span>):</span><br><span class="line">    AES_ECB = AES.new(KEY, AES.MODE_ECB)  <span class="comment"># 创建ECB模式的AES解密器</span></span><br><span class="line">    decrypted = AES_ECB.decrypt(long_to_bytes(c))  <span class="comment"># 解密输入</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> decrypted.<span class="built_in">hex</span>()  <span class="comment"># 返回解密结果的十六进制表示</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>():</span><br><span class="line">    iv = os.urandom(<span class="number">16</span>)  <span class="comment"># 生成16字节的随机初始化向量(IV)</span></span><br><span class="line">    AES_CBC = AES.new(KEY, AES.MODE_CBC, iv)  <span class="comment"># 创建CBC模式的AES加密器</span></span><br><span class="line">    encrypted = AES_CBC.encrypt(FLAG.encode())  <span class="comment"># 加密FLAG</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;iv:&#x27;</span>,iv.<span class="built_in">hex</span>())  <span class="comment"># 打印IV的十六进制表示</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> iv.<span class="built_in">hex</span>() + encrypted.<span class="built_in">hex</span>()  <span class="comment"># 返回IV和密文的拼接</span></span><br><span class="line"></span><br><span class="line">c=encrypt()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;encrypt:&#x27;</span>,c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;decrypt:&#x27;</span>,decrypt(<span class="built_in">int</span>(c,<span class="number">16</span>)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#encrypt: f2040fe3063a5b6c65f66e1d2bf47b4cddb206e4ddcf7524932d25e92d57d3468398730b59df851cbac6d65073f9e138</span></span><br><span class="line"><span class="comment">#什么是AES啊😭，求求你帮我解密吧，我什么都会做的！！！！！😭</span></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">什么都会做？那就去学习一下AES的工作模式吧……</span></span><br><span class="line"><span class="string">我这次就先给你解一下好了，不用谢喵</span></span><br><span class="line"><span class="string">decrypt: f9899749fec184d81afecd35da430bc394686e847d72141b3a955a4f6e920e7d91cb599d92ba2a6ba51860bb5b32f23b</span></span><br><span class="line"><span class="string">这对吗？哦不对不对，哦对的对的。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>这个加密过程很清晰</p>
<p>先进行ECB模式的加密，再进行CBC模式的解密，给了我们加密和解密的结果，还有密钥</p>
<p>先简单介绍一下AES加密的ECB和CBC模式吧</p>
<h4 id="加密算法"><a class="markdownIt-Anchor" href="#加密算法"></a> 加密算法</h4>
<p><img src="../images/20250614173346792.png" alt="image-20250614173346792" /></p>
<p><strong>ECB:</strong></p>
<p><strong>将密文分成几块，每一块单独加密，互不影响，密钥相同</strong></p>
<p><strong>CBC：</strong></p>
<p><strong>将密文分成几块，每个待加密的密码块在加密前会先与前一个密码块的密文异或然后再用加密器加密。第一个明文块与一个叫初始化向量（IV）的数据块异或。</strong></p>
<p><strong>解密时要把和 key 进行块解密操作后的块和前一个密文块（第一个密文块和 iv）异或后才能得到明文块。</strong></p>
<h4 id="解题"><a class="markdownIt-Anchor" href="#解题"></a> 解题</h4>
<p>已知明文是被 encrypt () 函数加密的，是一个 CBC 模式，所以我们只要知道 iv 和 key 就可以解密了，iv 其实很好知道，因为我们知道 encrypt，它是 iv 和密文的十六进制，因为我们知道 iv 是 16 个字节，那么 encrypt 的前 32 个字符就是 iv（每个字节对应两个十六进制字符数）</p>
<p>但是我们不知道 key 呀，怎么办呢，让我们看看喵帮我们干了什么，嗯，它用 ECB 模式解密了我们的明文，这不对吧？但是只要我们观察一下，就会发现用 ECB 模式解密和 CBC 模式就差一步异或，这样我们就不用知道 key 了，只要异或就行了</p>
<p>解密脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment"># CBC encrypt</span></span><br><span class="line">E = <span class="string">&#x27;f2040fe3063a5b6c65f66e1d2bf47b4cddb206e4ddcf7524932d25e92d57d3468398730b59df851cbac6d65073f9e138&#x27;</span></span><br><span class="line"><span class="comment"># ECB decrypt</span></span><br><span class="line">D = <span class="string">&#x27;f9899749fec184d81afecd35da430bc394686e847d72141b3a955a4f6e920e7d91cb599d92ba2a6ba51860bb5b32f23b&#x27;</span></span><br><span class="line"></span><br><span class="line">E = <span class="built_in">bytes</span>.fromhex(E)</span><br><span class="line">D = <span class="built_in">bytes</span>.fromhex(D)</span><br><span class="line">iv = E[:<span class="number">16</span>]</span><br><span class="line">c1 = E[<span class="number">16</span>:<span class="number">32</span>]</span><br><span class="line">c2 = E[<span class="number">32</span>:<span class="number">48</span>]</span><br><span class="line">m1 = D[<span class="number">16</span>:<span class="number">32</span>]</span><br><span class="line">m2 = D[<span class="number">32</span>:<span class="number">48</span>]</span><br><span class="line"><span class="comment">#这里c1,c2是CBC加密后的密文块</span></span><br><span class="line"><span class="comment">#m1,m2是ECB解密后的中间块</span></span><br><span class="line"><span class="comment">#加密满足的关系是:F1^iv=m1  F2^c1=m2</span></span><br><span class="line"><span class="comment">#因此倒置异或即可得到F1,F2</span></span><br><span class="line"></span><br><span class="line">F1 = xor(m1, iv)</span><br><span class="line">F2 = xor(m2, c1)</span><br><span class="line"><span class="built_in">print</span>(F1 + F2)</span><br></pre></td></tr></table></figure>
<p>官方exp:</p>
<p><strong>十进制和十六进制 long_to_bytes 的结果是一样的</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes <span class="keyword">as</span> l2b , bytes_to_long <span class="keyword">as</span> b2l</span><br><span class="line"></span><br><span class="line">c = <span class="number">0xf2040fe3063a5b6c65f66e1d2bf47b4cddb206e4ddcf7524932d25e92d57d3468398730b59df851cbac6d65073f9e138</span></span><br><span class="line">d = <span class="number">0xf9899749fec184d81afecd35da430bc394686e847d72141b3a955a4f6e920e7d91cb599d92ba2a6ba51860bb5b32f23b</span></span><br><span class="line"></span><br><span class="line">part1=l2b( b2l(l2b(c)[<span class="number">0</span>:<span class="number">16</span>]) ^ b2l(l2b(d)[<span class="number">16</span>:<span class="number">32</span>]))</span><br><span class="line">part2=l2b( b2l(l2b(c)[<span class="number">16</span>:<span class="number">32</span>]) ^ b2l(l2b(d)[<span class="number">32</span>:<span class="number">48</span>]))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(part1+part2)</span><br></pre></td></tr></table></figure>
<h3 id="两个黄鹂鸣翠柳-关联信息攻击-half-gcd算法"><a class="markdownIt-Anchor" href="#两个黄鹂鸣翠柳-关联信息攻击-half-gcd算法"></a> 两个黄鹂鸣翠柳 （关联信息攻击 Half-gcd算法）</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    delta = getPrime(<span class="number">1024</span>)</span><br><span class="line">    p = getPrime(<span class="number">512</span>)</span><br><span class="line">    q = getPrime(<span class="number">512</span>)</span><br><span class="line">    N = p * q</span><br><span class="line">    <span class="keyword">if</span> delta&lt;N:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;xxxxxxxxxxxxx&#125;&#x27;</span></span><br><span class="line">e = getPrime(<span class="number">10</span>)</span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line">t1 = random.randint(<span class="number">0</span>,<span class="number">255</span>)</span><br><span class="line">t2 = random.randint(<span class="number">0</span>,<span class="number">255</span>)</span><br><span class="line"><span class="keyword">assert</span> (t1 != t2)</span><br><span class="line">m1 = m + t1 * delta</span><br><span class="line">m2 = m + t2 * delta</span><br><span class="line">c1 = <span class="built_in">pow</span>(m1, e, N)</span><br><span class="line">c2 = <span class="built_in">pow</span>(m2, e, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;e = &quot;</span>, e)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c1 = &quot;</span>, c1)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c2 = &quot;</span>, c2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;N = &quot;</span>, N)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;delta = &quot;</span>, delta)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">e =  683</span></span><br><span class="line"><span class="string">c1 =  56853945083742777151835031127085909289912817644412648006229138906930565421892378967519263900695394136817683446007470305162870097813202468748688129362479266925957012681301414819970269973650684451738803658589294058625694805490606063729675884839653992735321514315629212636876171499519363523608999887425726764249</span></span><br><span class="line"><span class="string">c2 =  89525609620932397106566856236086132400485172135214174799072934348236088959961943962724231813882442035846313820099772671290019212756417758068415966039157070499263567121772463544541730483766001321510822285099385342314147217002453558227066228845624286511538065701168003387942898754314450759220468473833228762416</span></span><br><span class="line"><span class="string">N =  147146340154745985154200417058618375509429599847435251644724920667387711123859666574574555771448231548273485628643446732044692508506300681049465249342648733075298434604272203349484744618070620447136333438842371753842299030085718481197229655334445095544366125552367692411589662686093931538970765914004878579967</span></span><br><span class="line"><span class="string">delta =  93400488537789082145777768934799642730988732687780405889371778084733689728835104694467426911976028935748405411688535952655119354582508139665395171450775071909328192306339433470956958987928467659858731316115874663323404280639312245482055741486933758398266423824044429533774224701791874211606968507262504865993</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>总的来说就是找到两个多项式的公因子，而这个值大概率就是 m1，之后就可以求解出明文。但具体原理有点复杂，用到了 Half-GCD 算法，看不懂一点</p>
<p><img src="../images/0250614185325016.png" alt="image-20250614185325016" /></p>
<p>大佬exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e =  <span class="number">683</span></span><br><span class="line">c1 =  <span class="number">56853945083742777151835031127085909289912817644412648006229138906930565421892378967519263900695394136817683446007470305162870097813202468748688129362479266925957012681301414819970269973650684451738803658589294058625694805490606063729675884839653992735321514315629212636876171499519363523608999887425726764249</span></span><br><span class="line">c2 =  <span class="number">89525609620932397106566856236086132400485172135214174799072934348236088959961943962724231813882442035846313820099772671290019212756417758068415966039157070499263567121772463544541730483766001321510822285099385342314147217002453558227066228845624286511538065701168003387942898754314450759220468473833228762416</span></span><br><span class="line">N =  <span class="number">147146340154745985154200417058618375509429599847435251644724920667387711123859666574574555771448231548273485628643446732044692508506300681049465249342648733075298434604272203349484744618070620447136333438842371753842299030085718481197229655334445095544366125552367692411589662686093931538970765914004878579967</span></span><br><span class="line">delta =  <span class="number">93400488537789082145777768934799642730988732687780405889371778084733689728835104694467426911976028935748405411688535952655119354582508139665395171450775071909328192306339433470956958987928467659858731316115874663323404280639312245482055741486933758398266423824044429533774224701791874211606968507262504865993</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gcd</span>(<span class="params">g1, g2</span>):</span><br><span class="line">    <span class="keyword">while</span> g2:</span><br><span class="line">        g1, g2 = g2, g1 % g2</span><br><span class="line">    <span class="keyword">return</span> g1.monic()</span><br><span class="line"></span><br><span class="line">PR.&lt;x&gt; = PolynomialRing(Zmod(N))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> trange(-<span class="number">255</span>, <span class="number">256</span>):</span><br><span class="line">    f1 = (x + i * delta)^e - c1</span><br><span class="line">    f2 = (x)^e - c2</span><br><span class="line">    res = gcd(f1, f2).coefficients()[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">if</span> (res != <span class="number">1</span>):</span><br><span class="line">        res = -res</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="built_in">print</span>(res)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">255</span>, <span class="number">256</span>):</span><br><span class="line">        m = (res + j * delta) % N</span><br><span class="line">        flag = long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line">        <span class="keyword">if</span> (<span class="string">b&#x27;flag&#x27;</span> <span class="keyword">in</span> flag):</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>官方exp:</p>
<p>这里需要在sagemathshell上运行</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">HGCD</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="number">2</span> * b.degree() &lt;= a.degree() <span class="keyword">or</span> a.degree() == <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    m = a.degree() // <span class="number">2</span></span><br><span class="line">    a_top, a_bot = a.quo_rem(x ^ m)</span><br><span class="line">    b_top, b_bot = b.quo_rem(x ^ m)</span><br><span class="line">    R00, R01, R10, R11 = HGCD(a_top, b_top)</span><br><span class="line">    c = R00 * a + R01 * b</span><br><span class="line">    d = R10 * a + R11 * b</span><br><span class="line">    q, e = c.quo_rem(d)</span><br><span class="line">    d_top, d_bot = d.quo_rem(x ^ (m // <span class="number">2</span>))</span><br><span class="line">    e_top, e_bot = e.quo_rem(x ^ (m // <span class="number">2</span>))</span><br><span class="line">    S00, S01, S10, S11 = HGCD(d_top, e_top)</span><br><span class="line">    RET00 = S01 * R00 + (S00 - q * S01) * R10</span><br><span class="line">    RET01 = S01 * R01 + (S00 - q * S01) * R11</span><br><span class="line">    RET10 = S11 * R00 + (S10 - q * S11) * R10</span><br><span class="line">    RET11 = S11 * R01 + (S10 - q * S11) * R11</span><br><span class="line">    <span class="keyword">return</span> RET00, RET01, RET10, RET11</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GCD</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="built_in">print</span>(a.degree(), b.degree())</span><br><span class="line">    q, r = a.quo_rem(b)</span><br><span class="line">    <span class="keyword">if</span> r == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> b</span><br><span class="line">    R00, R01, R10, R11 = HGCD(a, b)</span><br><span class="line">    c = R00 * a + R01 * b</span><br><span class="line">    d = R10 * a + R11 * b</span><br><span class="line">    <span class="keyword">if</span> d == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> c.monic()</span><br><span class="line">    q, r = c.quo_rem(d)</span><br><span class="line">    <span class="keyword">if</span> r == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> d</span><br><span class="line">    <span class="keyword">return</span> GCD(d, r)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">e =  <span class="number">683</span></span><br><span class="line">c1 =  <span class="number">56853945083742777151835031127085909289912817644412648006229138906930565421892378967519263900695394136817683446007470305162870097813202468748688129362479266925957012681301414819970269973650684451738803658589294058625694805490606063729675884839653992735321514315629212636876171499519363523608999887425726764249</span></span><br><span class="line">c2 =  <span class="number">89525609620932397106566856236086132400485172135214174799072934348236088959961943962724231813882442035846313820099772671290019212756417758068415966039157070499263567121772463544541730483766001321510822285099385342314147217002453558227066228845624286511538065701168003387942898754314450759220468473833228762416</span></span><br><span class="line">N =  <span class="number">147146340154745985154200417058618375509429599847435251644724920667387711123859666574574555771448231548273485628643446732044692508506300681049465249342648733075298434604272203349484744618070620447136333438842371753842299030085718481197229655334445095544366125552367692411589662686093931538970765914004878579967</span></span><br><span class="line">delta =  <span class="number">93400488537789082145777768934799642730988732687780405889371778084733689728835104694467426911976028935748405411688535952655119354582508139665395171450775071909328192306339433470956958987928467659858731316115874663323404280639312245482055741486933758398266423824044429533774224701791874211606968507262504865993</span></span><br><span class="line"></span><br><span class="line">is_flag = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> delt <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">255</span>, <span class="number">255</span>, <span class="number">8</span>):</span><br><span class="line"></span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(Zmod(N))</span><br><span class="line">    f = x ^ e - c1</span><br><span class="line">    g1 = ((x + (delt + <span class="number">0</span>) * delta) ^ e - c2) * ((x + (delt + <span class="number">1</span>) * delta) ^ e - c2)</span><br><span class="line">    g2 = ((x + (delt + <span class="number">2</span>) * delta) ^ e - c2) * ((x + (delt + <span class="number">3</span>) * delta) ^ e - c2)</span><br><span class="line">    g3 = ((x + (delt + <span class="number">4</span>) * delta) ^ e - c2) * ((x + (delt + <span class="number">5</span>) * delta) ^ e - c2)</span><br><span class="line">    g4 = ((x + (delt + <span class="number">6</span>) * delta) ^ e - c2) * ((x + (delt + <span class="number">7</span>) * delta) ^ e - c2)</span><br><span class="line">    <span class="keyword">if</span> delt == -<span class="number">7</span>:</span><br><span class="line">        g4 = ((x + (delt + <span class="number">6</span>) * delta) ^ e - c2)</span><br><span class="line">    g = g1 * g2 * g3 * g4</span><br><span class="line">    res = GCD(f, g)</span><br><span class="line">    m1 = <span class="built_in">int</span>(-res.monic().coefficients()[<span class="number">0</span>])</span><br><span class="line">    <span class="keyword">for</span> t1 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        m = (m1 % N - t1 * delta) % N</span><br><span class="line">        <span class="keyword">if</span> m &gt; <span class="number">0</span>:</span><br><span class="line">            flag = long_to_bytes(m)</span><br><span class="line">            <span class="keyword">if</span> flag[:<span class="number">4</span>] ==<span class="string">b&#x27;flag&#x27;</span>:</span><br><span class="line">                <span class="built_in">print</span>(flag)</span><br><span class="line">                is_flag = <span class="literal">True</span></span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> is_flag:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment"># flag&#123;V_me_the_flag&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="../images/20250614185205407.png" alt="image-20250614185205407" /></p>
<p><strong>脚本使用解析：</strong></p>
<p><strong><code>HGCD(a, b)</code></strong></p>
<ul>
<li><strong>作用</strong>：计算两个多项式 <code>a</code> 和 <code>b</code> 的 <strong>Half-GCD</strong>，返回一个变换矩阵 <code>(R00, R01, R10, R11)</code></li>
</ul>
<p><strong><code>GCD(a, b)</code></strong></p>
<ul>
<li><strong>作用</strong>：计算两个多项式 <code>a</code> 和 <code>b</code> 的 <strong>最大公约数（GCD）</strong>。</li>
<li><strong>流程</strong>：
<ol>
<li>如果 <code>b</code> 能整除 <code>a</code>，直接返回 <code>b</code>。</li>
<li>否则，调用 <code>HGCD</code> 获取降阶后的多项式 <code>c</code> 和 <code>d</code>。</li>
<li>对 <code>d</code> 和 <code>r</code>（余数）递归调用 <code>GCD</code>，直到余数为零。</li>
</ol>
</li>
</ul>
<p><strong>步骤：</strong></p>
<p><strong>初始化</strong>：</p>
<ul>
<li>定义多项式环 <code>PR.&lt;x&gt; = PolynomialRing(Zmod(N))</code>（在模 <code>N</code> 的多项式环中计算）。</li>
<li>构造多项式：
<ul>
<li><code>f = x^e - c1</code>（对应 <code>m1</code> 的方程）。</li>
<li><code>g = 多个 ((x + k * delta)^e - c2) 的乘积</code>（对应 <code>m2</code> 的可能方程，<code>k</code> 是 <code>t1 - t2</code> 的猜测值）。</li>
</ul>
</li>
</ul>
<p><strong>枚举 <code>delt</code></strong>：</p>
<ul>
<li><code>delt</code> 是 <code>t1 - t2</code> 的猜测值（范围 <code>-255</code> 到 <code>255</code>，步长 <code>8</code>）。</li>
<li>为了加速计算，脚本将 <code>g</code> 拆分为 <code>g1, g2, g3, g4</code> 的乘积，分批次处理。</li>
</ul>
<p><strong>计算 GCD</strong>：</p>
<ul>
<li>调用 <code>related_message_attack(f, g)</code> 计算 <code>f</code> 和 <code>g</code> 的 GCD。</li>
<li>如果 GCD 是线性多项式，其根就是 <code>m1</code>。</li>
</ul>
<p><strong>恢复 <code>m</code></strong>：</p>
<ul>
<li>从 <code>m1</code> 计算 <code>m = m1 - t1 * delta</code>（枚举 <code>t1</code> 的 256 种可能）。</li>
<li>检查 <code>m</code> 是否以 <code>b'flag'</code> 开头，找到正确明文。</li>
</ul>
<h3 id="故事新编-1vigenere加密"><a class="markdownIt-Anchor" href="#故事新编-1vigenere加密"></a> **故事新编 1(Vigenere加密) **</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line">zen1  = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">key1 = </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc1</span>(<span class="params">plaintext, key</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">shift_char</span>(<span class="params">c, k</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">chr</span>(((<span class="built_in">ord</span>(c) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) + (<span class="built_in">ord</span>(k) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>))) % <span class="number">26</span>) + <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>))</span><br><span class="line"></span><br><span class="line">    plaintext = plaintext.upper()</span><br><span class="line">    key = key.upper()</span><br><span class="line">    ciphertext = []</span><br><span class="line">    key_index = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> plaintext:</span><br><span class="line">        <span class="keyword">if</span> char.isalpha():</span><br><span class="line">            ciphertext.append(shift_char(char, key[key_index % <span class="built_in">len</span>(key)]))</span><br><span class="line">            key_index += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            ciphertext.append(char)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(ciphertext)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;enc = \&#x27;\&#x27;\&#x27;&#x27;</span> + enc1(zen1, key1)+<span class="string">&#x27;\&#x27;\&#x27;\&#x27;&#x27;</span>)</span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;&#x27;</span>+md5(zen1.encode()).hexdigest().encode()+<span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#----------------------------------------------</span></span><br><span class="line">enc = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">TYBNBBZNT WF TYUMMK NAIB HYFZ.</span></span><br><span class="line"><span class="string">XFIFBKWG AM CXBMYK BVNF CNITBWBB.</span></span><br><span class="line"><span class="string">GVEJMX QL VXBHRJ NITV VIFXZRP.</span></span><br><span class="line"><span class="string">WPFXEYQ QG OWNUXZ MBTV QBEJMBKTNXL.</span></span><br><span class="line"><span class="string">TYSN JL JXNMMF GZUO GMLNXL.</span></span><br><span class="line"><span class="string">GCSLTX QL VXBHRJ NITV WYGAS.</span></span><br><span class="line"><span class="string">SDUHT QL PXOSAWLF</span></span><br><span class="line"><span class="string">KMTXTJWYANZ VWNHMA.</span></span><br><span class="line"><span class="string">GCWWJTT VULMG NJYO&#x27;M AIYVQOY WHPNOA NH JFRSE UAM KOEMG.</span></span><br><span class="line"><span class="string">NDNIHCZB IZOPLCDTTBNR JSNLM QNZBNR.</span></span><br><span class="line"><span class="string">MFEGLT LPHOEL BRNYS IILM LQZRFNMR.</span></span><br><span class="line"><span class="string">CGFXAG RPJMBKBNEG GVDYOVMW.</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>一眼维基密亚加密</p>
<p>维吉尼亚加密则使用 <strong>一组不同的偏移量</strong> 来循环加密，这组偏移量由一个 <strong>密钥（Key）</strong> 决定。</p>
<p>举例：</p>
<p><img src="../images/image-20250820222209554.png" alt="image-20250820222209554" /></p>
<p>在不知道key的情况下，我们只能借助一些词频分析类的在线网站去解密</p>
<p><a target="_blank" rel="noopener" href="https://www.guballa.de/vigenere-solver">Vigenere Solver | guballa.de</a></p>
<p><img src="../images/0250616180019625.png" alt="image-20250616180019625" /></p>
<p>解密出来了可读的东西</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">s=&#x27;&#x27;&#x27;</span><br><span class="line">BEAUTIFUL IS BETTER THAN UGLY.</span><br><span class="line">EXPLICIT IS BETTER THAN IMPLICIT.</span><br><span class="line">SIMPLE IS BETTER THAN COMPLEX.</span><br><span class="line">COMPLEX IS BETTER THAN COMPLICATED.</span><br><span class="line">FLAT IS BETTER THAN NESTED.</span><br><span class="line">SPARSE IS BETTER THAN DENSE.</span><br><span class="line">FLAGA IS VEGENERE</span><br><span class="line">READABILITY COUNTS.</span><br><span class="line">SPECIAL CASES AREN&#x27;T SPECIAL ENOUGH TO BREAK THE RULES.</span><br><span class="line">ALTHOUGH PRACTICALITY BEATS PURITY.</span><br><span class="line">ERRORS SHOULD NEVER PASS SILENTLY.</span><br><span class="line">UNLESS EXPLICITLY SILENCED.</span><br><span class="line">&#x27;&#x27;&#x27;</span><br><span class="line">这里注意格式，不要多加换行，微小的改变都会导致flag错误，得到解密结果后</span><br></pre></td></tr></table></figure>
<p>然后通过</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag = b&#x27;flag&#123;&#x27;+md5(zen1.encode()).hexdigest().encode()+b&#x27;&#125;&#x27;</span><br></pre></td></tr></table></figure>
<p>打印出flag</p>
<p>解密：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line">s=<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">BEAUTIFUL IS BETTER THAN UGLY.</span></span><br><span class="line"><span class="string">EXPLICIT IS BETTER THAN IMPLICIT.</span></span><br><span class="line"><span class="string">SIMPLE IS BETTER THAN COMPLEX.</span></span><br><span class="line"><span class="string">COMPLEX IS BETTER THAN COMPLICATED.</span></span><br><span class="line"><span class="string">FLAT IS BETTER THAN NESTED.</span></span><br><span class="line"><span class="string">SPARSE IS BETTER THAN DENSE.</span></span><br><span class="line"><span class="string">FLAGA IS VEGENERE</span></span><br><span class="line"><span class="string">READABILITY COUNTS.</span></span><br><span class="line"><span class="string">SPECIAL CASES AREN&#x27;T SPECIAL ENOUGH TO BREAK THE RULES.</span></span><br><span class="line"><span class="string">ALTHOUGH PRACTICALITY BEATS PURITY.</span></span><br><span class="line"><span class="string">ERRORS SHOULD NEVER PASS SILENTLY.</span></span><br><span class="line"><span class="string">UNLESS EXPLICITLY SILENCED.</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;&#x27;</span>+md5(s.encode()).hexdigest().encode()+<span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<h3 id="故事新编-2自动密钥加密vigenere"><a class="markdownIt-Anchor" href="#故事新编-2自动密钥加密vigenere"></a> <strong>故事新编 2（自动密钥加密+Vigenere）</strong></h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> md5</span><br><span class="line">zen2 = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">key2 = </span><br><span class="line">dict1 = &#123;<span class="string">&#x27;A&#x27;</span>: <span class="number">0</span>, <span class="string">&#x27;B&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;C&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;D&#x27;</span>: <span class="number">3</span>, <span class="string">&#x27;E&#x27;</span>: <span class="number">4</span>,</span><br><span class="line">         <span class="string">&#x27;F&#x27;</span>: <span class="number">5</span>, <span class="string">&#x27;G&#x27;</span>: <span class="number">6</span>, <span class="string">&#x27;H&#x27;</span>: <span class="number">7</span>, <span class="string">&#x27;I&#x27;</span>: <span class="number">8</span>, <span class="string">&#x27;J&#x27;</span>: <span class="number">9</span>,</span><br><span class="line">         <span class="string">&#x27;K&#x27;</span>: <span class="number">10</span>, <span class="string">&#x27;L&#x27;</span>: <span class="number">11</span>, <span class="string">&#x27;M&#x27;</span>: <span class="number">12</span>, <span class="string">&#x27;N&#x27;</span>: <span class="number">13</span>, <span class="string">&#x27;O&#x27;</span>: <span class="number">14</span>,</span><br><span class="line">         <span class="string">&#x27;P&#x27;</span>: <span class="number">15</span>, <span class="string">&#x27;Q&#x27;</span>: <span class="number">16</span>, <span class="string">&#x27;R&#x27;</span>: <span class="number">17</span>, <span class="string">&#x27;S&#x27;</span>: <span class="number">18</span>, <span class="string">&#x27;T&#x27;</span>: <span class="number">19</span>,</span><br><span class="line">         <span class="string">&#x27;U&#x27;</span>: <span class="number">20</span>, <span class="string">&#x27;V&#x27;</span>: <span class="number">21</span>, <span class="string">&#x27;W&#x27;</span>: <span class="number">22</span>, <span class="string">&#x27;X&#x27;</span>: <span class="number">23</span>, <span class="string">&#x27;Y&#x27;</span>: <span class="number">24</span>, <span class="string">&#x27;Z&#x27;</span>: <span class="number">25</span>&#125;</span><br><span class="line"></span><br><span class="line">dict2 = &#123;<span class="number">0</span>: <span class="string">&#x27;A&#x27;</span>, <span class="number">1</span>: <span class="string">&#x27;B&#x27;</span>, <span class="number">2</span>: <span class="string">&#x27;C&#x27;</span>, <span class="number">3</span>: <span class="string">&#x27;D&#x27;</span>, <span class="number">4</span>: <span class="string">&#x27;E&#x27;</span>,</span><br><span class="line">         <span class="number">5</span>: <span class="string">&#x27;F&#x27;</span>, <span class="number">6</span>: <span class="string">&#x27;G&#x27;</span>, <span class="number">7</span>: <span class="string">&#x27;H&#x27;</span>, <span class="number">8</span>: <span class="string">&#x27;I&#x27;</span>, <span class="number">9</span>: <span class="string">&#x27;J&#x27;</span>,</span><br><span class="line">         <span class="number">10</span>: <span class="string">&#x27;K&#x27;</span>, <span class="number">11</span>: <span class="string">&#x27;L&#x27;</span>, <span class="number">12</span>: <span class="string">&#x27;M&#x27;</span>, <span class="number">13</span>: <span class="string">&#x27;N&#x27;</span>, <span class="number">14</span>: <span class="string">&#x27;O&#x27;</span>,</span><br><span class="line">         <span class="number">15</span>: <span class="string">&#x27;P&#x27;</span>, <span class="number">16</span>: <span class="string">&#x27;Q&#x27;</span>, <span class="number">17</span>: <span class="string">&#x27;R&#x27;</span>, <span class="number">18</span>: <span class="string">&#x27;S&#x27;</span>, <span class="number">19</span>: <span class="string">&#x27;T&#x27;</span>,</span><br><span class="line">         <span class="number">20</span>: <span class="string">&#x27;U&#x27;</span>, <span class="number">21</span>: <span class="string">&#x27;V&#x27;</span>, <span class="number">22</span>: <span class="string">&#x27;W&#x27;</span>, <span class="number">23</span>: <span class="string">&#x27;X&#x27;</span>, <span class="number">24</span>: <span class="string">&#x27;Y&#x27;</span>, <span class="number">25</span>: <span class="string">&#x27;Z&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_key</span>(<span class="params">message, key</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(message)):</span><br><span class="line">        <span class="keyword">if</span> message[i].isalpha() == <span class="literal">False</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            key += message[i]</span><br><span class="line">    <span class="keyword">return</span> key</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">enc2</span>(<span class="params">message, key</span>):</span><br><span class="line">    message = message.upper()</span><br><span class="line">    key = key.upper()</span><br><span class="line">    key_new = generate_key(message, key)</span><br><span class="line">    cipher_text = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> letter <span class="keyword">in</span> message:</span><br><span class="line">        <span class="keyword">if</span> letter.isalpha():</span><br><span class="line">            x = (dict1[letter]+dict1[key_new[i]]) % <span class="number">26</span></span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line">            cipher_text += dict2[x]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            cipher_text += letter</span><br><span class="line">    <span class="keyword">return</span> cipher_text</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;enc = \&#x27;\&#x27;\&#x27;&#x27;</span> + enc2(zen2, key2)+<span class="string">&#x27;\&#x27;\&#x27;\&#x27;&#x27;</span>)</span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;&#x27;</span>+md5(zen2.encode()).hexdigest().encode()+<span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#----------------------------------------------</span></span><br><span class="line">enc = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">AH ILV XUDX WY UFJWTCVMF, VJFWWS YHQ UMSJBTRZSS NG KNLWL.</span></span><br><span class="line"><span class="string">XTTKE LPCHER HY SFW-- TUH GVWMSLLEMC CAPY BQT --FFAMFUT HYM GZ BC VX.</span></span><br><span class="line"><span class="string">OMOPCOYD TFTH ZOG FAJ GVH VK VUCIHQS YF FGEGM VRZFNA MIM&#x27;RX ICKUA.</span></span><br><span class="line"><span class="string">HBH MK TCHNVV WBTP URJAZ.</span></span><br><span class="line"><span class="string">SMXAHYXA UEIRV DW FFEXU PYZARV OLRV JWLAX APA.</span></span><br><span class="line"><span class="string">BY XYX PMCCMSLGGOPQTG PW PMGO XA IKILTQB, VB&#x27;K H BRG BRIX.</span></span><br><span class="line"><span class="string">XQ TPR QFHLFMHVWETQTG PW MMHJ XA IKILTQB, VB EEY TC T USLS TDMN.</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>将明文添加到key的后面，形成新key，再根据新key和明文查表得到密文，问题在于，如果能知道原来的key，那么一切都能倒推回去，如果不知道呢？爆破吗？不太现实，看了题解，才知道这种类型属于自动密钥加密，用刚刚那个网站同样可以解密，只不过需要把解密方式改为Autokey Vegenere</p>
<p><img src="../images/image-20250820231840050.png" alt="image-20250820231840050" /></p>
<p>得到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">IN THE FACE OF AMBIGUITY, REFUSE THE TEMPTATION TO GUESS.</span><br><span class="line">THERE SHOULD BE ONE-- AND PREFERABLY ONLY ONE --OBVIOUS WAY TO DO IT.</span><br><span class="line">ALTHOUGH THAT WAY MAY NOT BE OBVIOUS AT FIRST UNLESS YOU&#x27;RE DUTCH.</span><br><span class="line">NOW IS BETTER THAN NEVER.</span><br><span class="line">ALTHOUGH NEVER IS OFTEN BETTER THAN RIGHT NOW.</span><br><span class="line">IF THE IMPLEMENTATION IS HARD TO EXPLAIN, IT&#x27;S A BAD IDEA.</span><br><span class="line">IF THE IMPLEMENTATION IS EASY TO EXPLAIN, IT MAY BE A GOOD IDEA.</span><br></pre></td></tr></table></figure>
<p>然后逆推解密就行了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> *</span><br><span class="line">s=<span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">IN THE FACE OF AMBIGUITY, REFUSE THE TEMPTATION TO GUESS.</span></span><br><span class="line"><span class="string">THERE SHOULD BE ONE-- AND PREFERABLY ONLY ONE --OBVIOUS WAY TO DO IT.</span></span><br><span class="line"><span class="string">ALTHOUGH THAT WAY MAY NOT BE OBVIOUS AT FIRST UNLESS YOU&#x27;RE DUTCH.</span></span><br><span class="line"><span class="string">NOW IS BETTER THAN NEVER.</span></span><br><span class="line"><span class="string">ALTHOUGH NEVER IS OFTEN BETTER THAN RIGHT NOW.</span></span><br><span class="line"><span class="string">IF THE IMPLEMENTATION IS HARD TO EXPLAIN, IT&#x27;S A BAD IDEA.</span></span><br><span class="line"><span class="string">IF THE IMPLEMENTATION IS EASY TO EXPLAIN, IT MAY BE A GOOD IDEA.</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(s.lower())</span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;&#x27;</span>+md5(s.encode()).hexdigest().encode()+<span class="string">b&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#b&#x27;flag&#123;169a1eccefe15ea58ecc7b6d14df1d09&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="没e这能玩离散对数"><a class="markdownIt-Anchor" href="#没e这能玩离散对数"></a> 没e这能玩(离散对数)</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> sympy</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">m = bytes_to_long(<span class="string">b&#x27;flag&#123;*****&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">r = getPrime(<span class="number">512</span>)</span><br><span class="line">h1 = <span class="number">1</span>*p + <span class="number">1</span>*q + <span class="number">1</span>*r</span><br><span class="line">h2 = <span class="number">2</span>*p + <span class="number">3</span>*q + <span class="number">3</span>*r</span><br><span class="line">h3 = <span class="number">9</span>*p + <span class="number">9</span>*q + <span class="number">6</span>*r</span><br><span class="line"><span class="built_in">print</span>( <span class="string">&quot;hint_of_pqr=&quot;</span> , h1 , h2 , h3 )</span><br><span class="line"></span><br><span class="line">e = getPrime(<span class="number">64</span>)</span><br><span class="line">a_big_prime = getPrime( <span class="number">512</span> )</span><br><span class="line">hint = <span class="built_in">pow</span>(a_big_prime,e,<span class="number">2</span>**<span class="number">512</span>)</span><br><span class="line"><span class="built_in">print</span>( <span class="string">&quot;big_prime is: &quot;</span> , a_big_prime )</span><br><span class="line"><span class="built_in">print</span>( <span class="string">&quot;hint is: &quot;</span> , hint )</span><br><span class="line"></span><br><span class="line">n = p*q*r</span><br><span class="line">c = <span class="built_in">pow</span>( m , e , n )</span><br><span class="line"><span class="built_in">print</span>( <span class="string">&quot;c=&quot;</span> , c )</span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">hint_of_pqr= 31142735238530997044538008977536563192992446755282526163704097825748037157617958329370018716097695151853567914689441893020256819531959835133410539308633497 83244528500940968089139246591338465098116598400576450028712055615289379610182828415628469144649133540240957232351546273836449824638227295064400834828714760 248913032538718194100308575844236838621741774207751338576000867909773931464854644505429950530402814602955352740032796855486666128271187734043696395254816172 </span></span><br><span class="line"><span class="string">big_prime is:  10340528340717085562564282159472606844701680435801531596688324657589080212070472855731542530063656135954245247693866580524183340161718349111409099098622379</span></span><br><span class="line"><span class="string">hint is:  1117823254118009923270987314972815939020676918543320218102525712576467969401820234222225849595448982263008967497960941694470967789623418862506421153355571 </span></span><br><span class="line"><span class="string">c= 999238457633695875390868312148578206874085180328729864031502769160746939370358067645058746087858200698064715590068454781908941878234704745231616472500544299489072907525181954130042610756999951629214871917553371147513692253221476798612645630242018686268404850587754814930425513225710788525640827779311258012457828152843350882248473911459816471101547263923065978812349463656784597759143314955463199850172786928389414560476327593199154879575312027425152329247656310</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>
<p>一个变形rsa题目，要求出d就要求出q,p,r,e四个变量</p>
<p>其中q,p,r三个变量，三个等式，可以求出来</p>
<p>对于求e的话</p>
<p>给了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">e = getPrime(64)</span><br><span class="line">a_big_prime = getPrime( 512 )</span><br><span class="line">hint = pow(a_big_prime,e,2**512)</span><br></pre></td></tr></table></figure>
<p>a_big_prime已知，hint已知，求e，</p>
<p>参考了一些博客，知道是离散对数问题，但是我不太了解离散对数（之后会多看看的），然后直接在一个博客里就找到了一个库里的一个函数，可以直接求出e</p>
<p><strong>python的 sympy库discrete_log函数是专门求指数的，discrete_log(x,y,z)，x为模数，y为余数，z为底数</strong></p>
<p>例如：我们要解k</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mn>2</mn><mi>k</mi></msup><mo>≡</mo><mn>5</mn><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mn>13</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">2^k≡5(mod13)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8991079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">5</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord">1</span><span class="mord">3</span><span class="mclose">)</span></span></span></span></span></p>
<p>直接</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sympy.ntheory.residue_ntheory <span class="keyword">import</span> discrete_log</span><br><span class="line"></span><br><span class="line">x = <span class="number">13</span>   <span class="comment"># 模数</span></span><br><span class="line">z = <span class="number">2</span>    <span class="comment"># 底数</span></span><br><span class="line">y = <span class="number">5</span>    <span class="comment"># 余数</span></span><br><span class="line"></span><br><span class="line">k = discrete_log(x, y, z)</span><br><span class="line"><span class="built_in">print</span>(k)</span><br></pre></td></tr></table></figure>
<p>用这个函数求出来e后就是RSA解密的经典过程了</p>
<p><strong>求p,q,r：</strong><br />
有两种方法,第一种是公式：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">p = 3 * h1 - h2</span><br><span class="line">r = (9 * h1 - h3)//3</span><br><span class="line">q = h1 - p - r</span><br></pre></td></tr></table></figure>
<p>第二种是用python中的 <strong>sympy</strong> 解一个三元一次方程组：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># importing library sympy</span></span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> symbols, Eq, solve</span><br><span class="line"></span><br><span class="line">h1=<span class="number">31142735238530997044538008977536563192992446755282526163704097825748037157617958329370018716097695151853567914689441893020256819531959835133410539308633497</span></span><br><span class="line">h2=<span class="number">83244528500940968089139246591338465098116598400576450028712055615289379610182828415628469144649133540240957232351546273836449824638227295064400834828714760</span></span><br><span class="line">h3=<span class="number">248913032538718194100308575844236838621741774207751338576000867909773931464854644505429950530402814602955352740032796855486666128271187734043696395254816172</span></span><br><span class="line"></span><br><span class="line">p,q,r = symbols(<span class="string">&#x27;p,q,r&#x27;</span>)</span><br><span class="line">eq1 = Eq((<span class="number">1</span>*p + <span class="number">1</span>*q + <span class="number">1</span>*r), h1)</span><br><span class="line">eq2 = Eq((<span class="number">2</span>*p + <span class="number">3</span>*q + <span class="number">3</span>*r), h2)</span><br><span class="line">eq3 = Eq((<span class="number">9</span>*p + <span class="number">9</span>*q + <span class="number">6</span>*r), h3)</span><br><span class="line"><span class="built_in">print</span>(solve((eq1, eq2, eq3), (p,q,r)))</span><br><span class="line"></span><br><span class="line"><span class="comment">#&#123;p: 10183677214652023044474780341271224480860741865271128462400237861954731862671046572481587003643951915319746511716779405224320633957652210335830783097185731, q: 10501863154525380899885393651734595340401622693414265402191855789807170977044584937255025740961595981958235238915269093897387769735490697411913603370485999, r: 10457194869353593100177834984530743371730082196597132299112004173986134317902326819633405971492147254575586164057393393898548415838816927385666152840961767&#125;</span></span><br></pre></td></tr></table></figure>
<p>求e+flag:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">from</span> mpmath <span class="keyword">import</span> invertlaplace</span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> discrete_log</span><br><span class="line"></span><br><span class="line">p=<span class="number">10183677214652023044474780341271224480860741865271128462400237861954731862671046572481587003643951915319746511716779405224320633957652210335830783097185731</span></span><br><span class="line">q=<span class="number">10501863154525380899885393651734595340401622693414265402191855789807170977044584937255025740961595981958235238915269093897387769735490697411913603370485999</span></span><br><span class="line">r=<span class="number">10457194869353593100177834984530743371730082196597132299112004173986134317902326819633405971492147254575586164057393393898548415838816927385666152840961767</span></span><br><span class="line">big_prime=<span class="number">10340528340717085562564282159472606844701680435801531596688324657589080212070472855731542530063656135954245247693866580524183340161718349111409099098622379</span></span><br><span class="line">hint=<span class="number">1117823254118009923270987314972815939020676918543320218102525712576467969401820234222225849595448982263008967497960941694470967789623418862506421153355571</span></span><br><span class="line">c= <span class="number">999238457633695875390868312148578206874085180328729864031502769160746939370358067645058746087858200698064715590068454781908941878234704745231616472500544299489072907525181954130042610756999951629214871917553371147513692253221476798612645630242018686268404850587754814930425513225710788525640827779311258012457828152843350882248473911459816471101547263923065978812349463656784597759143314955463199850172786928389414560476327593199154879575312027425152329247656310</span></span><br><span class="line"></span><br><span class="line">e = discrete_log(<span class="number">2</span>**<span class="number">512</span>, hint, big_prime)</span><br><span class="line"><span class="built_in">print</span>(e)</span><br><span class="line"></span><br><span class="line">n = p*q*r</span><br><span class="line">phi = (p-<span class="number">1</span>)*(q-<span class="number">1</span>)*(r-<span class="number">1</span>)</span><br><span class="line">d=gmpy2.invert(e, phi)</span><br><span class="line"><span class="built_in">print</span>(d)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment">#18344052974846453963</span></span><br><span class="line"><span class="comment">#353990565818625470203369777239314743702215915925233196685710922971035136745962920650978745767080817978533931486524755066350185911891300410592045053635868129756936833542534389569636562575622589318159685096070360444918245742399076155280089425194564103920810567326139574530309013616431270046381080112401477101628065595664594982640241027864708389381440505030265366815955626373592957956775853576195599726111052060073122365749364757456811923493380577927720503392159587</span></span><br><span class="line"><span class="comment">#b&#x27;flag&#123;th1s_2s_A_rea119_f34ggg&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<h2 id="week4"><a class="markdownIt-Anchor" href="#week4"></a> week4</h2>
<h3 id="俱以我之名维纳攻击"><a class="markdownIt-Anchor" href="#俱以我之名维纳攻击"></a> <strong>俱以我之名(维纳攻击)</strong></h3>
<h4 id="前置知识"><a class="markdownIt-Anchor" href="#前置知识"></a> 前置知识</h4>
<p><strong>维纳攻击：</strong><a target="_blank" rel="noopener" href="https://hasegawaazusa.github.io/wiener-attack.html#%E5%8E%9F%E7%90%86">wiener attack 笔记 | 独奏の小屋</a></p>
<p><strong>攻击条件</strong></p>
<p>e过大或过小。</p>
<p>在e过大或过小的情况下，可使用算法从e中快速推断出d的值。</p>
<p><img src="../images/image-20250821002331849.png" alt="image-20250821002331849" /></p>
<p>所以维纳攻击的步骤就是：</p>
<p><img src="../images/image-20250821004738926.png" alt="image-20250821004738926" /></p>
<h4 id="维纳攻击脚本sage"><a class="markdownIt-Anchor" href="#维纳攻击脚本sage"></a> 维纳攻击脚本(sage)</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">wienerAttack</span>(<span class="params">N, e</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    维纳攻击</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    `Parameters`:</span></span><br><span class="line"><span class="string">        N - p * q\\</span></span><br><span class="line"><span class="string">        e - public key</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    `Returns`:</span></span><br><span class="line"><span class="string">        p, q, d</span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line">    cf = continued_fraction(e / N)</span><br><span class="line">    convers = cf.convergents()</span><br><span class="line">    <span class="keyword">for</span> pkd <span class="keyword">in</span> convers:</span><br><span class="line">        <span class="comment"># possible k, d</span></span><br><span class="line">        pk, pd = pkd.as_integer_ratio()</span><br><span class="line">        <span class="keyword">if</span> pk == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># verify</span></span><br><span class="line">        <span class="keyword">if</span> (e * pd - <span class="number">1</span>) % pk != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># possible phi</span></span><br><span class="line">        pphi = (e * pd - <span class="number">1</span>) // pk</span><br><span class="line">        p = var(<span class="string">&#x27;p&#x27;</span>, domain=ZZ)</span><br><span class="line">        roots = solve(p ** <span class="number">2</span> + (pphi - N - <span class="number">1</span>) * p + N, p)</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(roots) == <span class="number">2</span>:</span><br><span class="line">            <span class="comment"># possible p, q</span></span><br><span class="line">            pp, pq = roots</span><br><span class="line">            <span class="keyword">if</span> pp * pq == N:</span><br><span class="line">                <span class="keyword">return</span> pp, pq, pd</span><br><span class="line">    <span class="keyword">raise</span> ValueError(<span class="string">&#x27;Could not factor N!&#x27;</span>)</span><br><span class="line"></span><br><span class="line">N = <span class="number">507419170088344932990702256911694788408493968749527614421614568612944144764889717229444020813658893362983714454159980719026366361318789415279417172858536381938870379267670180128174798344744371725609827872339512302232610590888649555446972990419313445687852636305518801236132032618350847705234643521557851434711389664130274468354405273873218264222293858509477860634889001898462547712800153111774564939279190835857445378261920532206352364005840238252284065587291779196975457288580812526597185332036342330147250312262816994625317482869849388424397437470502449815132000588425028055964432298176942124697105509057090546600330760364385753313923003549670107599757996810939165300581847068233156887269181096893089415302163770884312255957584660964506028002922164767453287973102961910781312351686488047510932997937700597992705557881172640175117476017503918294534205898046483981707558521558992058512940087192655700351675718815723840568640509355338482631416345193176708501897458649841539192993142790402734898948352382350766125000186026261167277014748183012844440603384989647664190074853086693408529737767147592432979469020671772152652865219092597717869942730499507426269170189547020660681363276871874469322437194397171763927907099922324375991793759</span></span><br><span class="line">e = <span class="number">77310199867448677782081572109343472783781135641712597643597122591443011229091533516758925238949755491395489408922437493670252550920826641442189683907973926843505436730014899918587477913032286153545247063493885982941194996251799882984145155733050069564485120660716110828110738784644223519725613280140006783618393995138076030616463398284819550627612102010214315235269945251741407899692274978642663650687157736417831290404871181902463904311095448368498432147292938825418930527188720696497596867575843476810225152659244529481480993843168383016583068747733118703000287423374094051895724494193455175131120243097065270804457787026492578916584536863548445813916819417857064037664101684455000184987531252344582899589746272173970083733130106407810619258077266603898529285634495710846838011858287024329514491058790557305041389614650730267774482954666726949886313386881066593946789460028399523245777171320319444673551268379126203862576627540177888290265714418064334752499940587750374552330008143708562065940245637685833371348603338834447212248648869514585047871442060412622164276894766238383894693759347590977926306581080390685360615407766600573527565016914830132066428454738135380178959590692145577418811677639050929791996313180297924833690095</span></span><br><span class="line">c = <span class="number">165251729917394529793163344300848992394021337429474789711805041655116845722480301677817165053253655027459227404782607373107477419083333844871948673626672704233977397989843349633720167495862807995411682262559392496273163155214888276398332204954185252030616473235814999366132031184631541209554169938146205402400412307638567132128690379079483633171535375278689326189057930259534983374296873110199636558962144635514392282351103900375366360933088605794654279480277782805401749872568584335215630740265944133347038070337891035560658434763924576508969938866566235926587685108811154229747423410476421860059769485356567301897413767088823807510568561254627099309752215808220067495561412081320541540679503218232020279947159175547517811501280846596226165148013762293861131544331444165070186672186027410082671602892508739473724143698396105392623164025712124329254933353509384748403154342322725203183050328143736631333990445537119855865348221215277608372952942702104088940952142851523651639574409075484106857403651453121036577767672430612728022444370874223001778580387635197325043524719396707713385963432915855227152371800527536048555551237729690663544828830627192867570345853910196397851763591543484023134551876591248557980182981967782409054277224</span></span><br><span class="line">p, q, d = wienerAttack(N, e)</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, N)</span><br></pre></td></tr></table></figure>
<h4 id="解题-2"><a class="markdownIt-Anchor" href="#解题-2"></a> 解题</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">msg, nbits</span>):</span><br><span class="line">    pad_length = nbits - <span class="built_in">len</span>(msg) * <span class="number">8</span> - <span class="number">8</span></span><br><span class="line">    <span class="keyword">assert</span> pad_length &gt;= <span class="number">0</span></span><br><span class="line">    pad = random.getrandbits(pad_length).to_bytes((pad_length + <span class="number">7</span>) // <span class="number">8</span>, <span class="string">&quot;big&quot;</span>)</span><br><span class="line">    padded_msg = pad[:<span class="built_in">len</span>(pad)//<span class="number">2</span>] + <span class="string">b&quot;\x00&quot;</span> + msg + pad[<span class="built_in">len</span>(pad)//<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> padded_msg</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">All_in_my_name</span>(<span class="params">p, q</span>):</span><br><span class="line">    <span class="comment">#开启三技能&lt;俱以我之名&gt;后，维娜立即在周围八格可部署地面召唤“黄金盟誓(Golden_Oath)”;对RSA造成真实伤害。</span></span><br><span class="line">    Golden_Oath = (p-<span class="number">114</span>)*(p-<span class="number">514</span>)*(p+<span class="number">114</span>)*(p+<span class="number">514</span>)*(q-<span class="number">1919</span>)*(q-<span class="number">810</span>)*(q+<span class="number">1919</span>)*(q+<span class="number">810</span>)</span><br><span class="line">    x = bytes_to_long(pad(gift, random.randint(bytes_to_long(gift).bit_length(), <span class="number">512</span>)))</span><br><span class="line">    y = inverse(x, Golden_Oath)</span><br><span class="line">    <span class="keyword">return</span> y</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;?????&#125;&#x27;</span></span><br><span class="line">gift = <span class="string">b&#x27;?????&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> gift[:<span class="number">3</span>] == <span class="string">b&#x27;end&#x27;</span></span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">n = p*q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(bytes_to_long(flag), e,n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;All_in_my_name = <span class="subst">&#123;All_in_my_name(p, q)&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 141425071303405369267688583480971314815032581405819618511016190023245950842423565456025578726768996255928405749476366742320062773129810617755239412667111588691998380868379955660483185372558973059599254495581547016729479937763213364591413126146102483671385285672028642742654014426993054793378204517214486744679</span></span><br><span class="line"><span class="string">c = 104575090683421063990494118954150936075812576661759942057772865980855195301985579098801745928083817885393369435101522784385677092942324668770336932487623099755265641877712097977929937088259347596039326198580193524065645826424819334664869152049049342316256537440449958526473368110002271943046726966122355888321</span></span><br><span class="line"><span class="string">All_in_my_name = 217574365691698773158073738993996550494156171844278669077189161825491226238745356969468902038533922854535578070710976002278064001201980326028443347187697136216041235312192490502479015081704814370278142850634739391445817028960623318683701439854891399013393469200033510113406165952272497324443526299141544564964545937461632903355647411273477731555390580525472533399606416576667193890128726061970653201509841276177937053500663438053151477018183074107182442711656306515049473061426018576304621373895497210927151796054531814746265988174146635716820986208719319296233956243559891444122410388128465897348458862921336261068868678669349968117097659195490792407141240846445006330031546721426459458395606505793093432806236790060342049066284307119546018491926250151057087562126580602631912562103705681810139118673506298916800665912859765635644796622382867334481599049728329203920912683317422430015635091565073203588723830512169316991557606976424732212785533550238950903858852917097354055547392337744369560947616517041907362337902584102983344969307971888314998036201926257375424706901999793914432814775462333942995267009264203787170147555384279151485485660683109778282239772043598128219664150933315760352868905799949049880756509591090387073778041</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>x</mi><mi>y</mi><mo>=</mo><mn>1</mn><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mi>G</mi><mi>o</mi><mi>l</mi><mi>d</mi><mi>e</mi><mi>n</mi><mi>O</mi><mi>a</mi><mi>t</mi><mi>h</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">xy=1 (modGoldenOath)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal">x</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">G</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord mathnormal">n</span><span class="mord mathnormal" style="margin-right:0.02778em;">O</span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span><span class="mclose">)</span></span></span></span></span></p>
<p>所以</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mfrac><mi>y</mi><mrow><mi>G</mi><mi>o</mi><mi>l</mi><mi>d</mi><mi>e</mi><msub><mi>n</mi><mi>O</mi></msub><mi>a</mi><mi>t</mi><mi>h</mi></mrow></mfrac><mo>=</mo><mfrac><mi>k</mi><mi>x</mi></mfrac></mrow><annotation encoding="application/x-tex">\frac{y}{Golden_Oath}=\frac{k}{x}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.94356em;vertical-align:-0.8360000000000001em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1075599999999999em;"><span style="top:-2.3139999999999996em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">G</span><span class="mord mathnormal">o</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">d</span><span class="mord mathnormal">e</span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">O</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">a</span><span class="mord mathnormal">t</span><span class="mord mathnormal">h</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8360000000000001em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.05744em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.37144em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">x</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>其中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GoldenOath=(p−114)(p−514)(p+114)(p+514)(q−1919)(q−810)(q+1919)(q+810)</span><br></pre></td></tr></table></figure>
<p>我们可以看成n的4次方</p>
<p>那我们对这个式子进行连分数展开，就能找到一系列近似值，再判断一下<code>’end’</code>在不在求出来的x里就可以找到x了，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">n = <span class="number">141425071303405369267688583480971314815032581405819618511016190023245950842423565456025578726768996255928405749476366742320062773129810617755239412667111588691998380868379955660483185372558973059599254495581547016729479937763213364591413126146102483671385285672028642742654014426993054793378204517214486744679</span></span><br><span class="line">c = <span class="number">104575090683421063990494118954150936075812576661759942057772865980855195301985579098801745928083817885393369435101522784385677092942324668770336932487623099755265641877712097977929937088259347596039326198580193524065645826424819334664869152049049342316256537440449958526473368110002271943046726966122355888321</span></span><br><span class="line">y = <span class="number">217574365691698773158073738993996550494156171844278669077189161825491226238745356969468902038533922854535578070710976002278064001201980326028443347187697136216041235312192490502479015081704814370278142850634739391445817028960623318683701439854891399013393469200033510113406165952272497324443526299141544564964545937461632903355647411273477731555390580525472533399606416576667193890128726061970653201509841276177937053500663438053151477018183074107182442711656306515049473061426018576304621373895497210927151796054531814746265988174146635716820986208719319296233956243559891444122410388128465897348458862921336261068868678669349968117097659195490792407141240846445006330031546721426459458395606505793093432806236790060342049066284307119546018491926250151057087562126580602631912562103705681810139118673506298916800665912859765635644796622382867334481599049728329203920912683317422430015635091565073203588723830512169316991557606976424732212785533550238950903858852917097354055547392337744369560947616517041907362337902584102983344969307971888314998036201926257375424706901999793914432814775462333942995267009264203787170147555384279151485485660683109778282239772043598128219664150933315760352868905799949049880756509591090387073778041</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ContinuedFraction</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, numerator, denumerator</span>):</span><br><span class="line">        <span class="variable language_">self</span>.numberlist = []</span><br><span class="line">        <span class="variable language_">self</span>.fractionlist = []</span><br><span class="line">        <span class="variable language_">self</span>.GenerateNumberList(numerator, denumerator)</span><br><span class="line">        <span class="variable language_">self</span>.GenerateFractionList()</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">GenerateNumberList</span>(<span class="params">self, numerator, denumerator</span>):</span><br><span class="line">        <span class="keyword">while</span> numerator != <span class="number">1</span>:</span><br><span class="line">            quotient = numerator // denumerator</span><br><span class="line">            remainder = numerator % denumerator</span><br><span class="line">            <span class="variable language_">self</span>.numberlist.append(quotient)</span><br><span class="line">            numerator = denumerator</span><br><span class="line">            denumerator = remainder</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">GenerateFractionList</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="variable language_">self</span>.fractionlist.append([<span class="variable language_">self</span>.numberlist[<span class="number">0</span>], <span class="number">1</span>])</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="built_in">len</span>(<span class="variable language_">self</span>.numberlist)):</span><br><span class="line">            numerator = <span class="variable language_">self</span>.numberlist[i]</span><br><span class="line">            denumerator = <span class="number">1</span></span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i):</span><br><span class="line">                temp = numerator</span><br><span class="line">                numerator = denumerator + numerator * <span class="variable language_">self</span>.numberlist[i - j - <span class="number">1</span>]</span><br><span class="line">                denumerator = temp</span><br><span class="line">            <span class="variable language_">self</span>.fractionlist.append([numerator, denumerator])</span><br><span class="line"></span><br><span class="line">n = <span class="built_in">pow</span>(n,<span class="number">4</span>)</span><br><span class="line">a = ContinuedFraction(y, n)</span><br><span class="line"><span class="keyword">for</span> k, x <span class="keyword">in</span> a.fractionlist:</span><br><span class="line">    <span class="comment"># 判断哪一个是我们所需的 x</span></span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;end&#x27;</span> <span class="keyword">in</span> long_to_bytes(x):</span><br><span class="line">        <span class="built_in">print</span>(x)</span><br><span class="line">        <span class="built_in">print</span>(k)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(x))</span><br><span class="line">Golden_Oath = (x*y-<span class="number">1</span>)//k</span><br><span class="line"><span class="built_in">print</span>(Golden_Oath)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">103697213497220650500739251621743955651854455782387759691953279488676501281257640431561</span></span><br><span class="line"><span class="string">56398712132783063027132828918468670442692437484816382768162819797891220782528221182512</span></span><br><span class="line"><span class="string">b&#x27;5`\xf4\xf6t\xa3\x00end1n9_A_G2@nd_Ov3RTu2e\x1c\x13&quot;H\x0f\xc9&#x27;</span></span><br><span class="line"><span class="string">#400042032831098007958224589201074030167511216235146696966889080122265111949126155016295896501799032251334875101500882585261911204171467951139573150807043239564581043145433814155757093989016940205116328236031283789686099217459678429270939065783626769903068201144816933538226628329294355184200590029028565011348654002192085571172863125467318356642528249715812871925525776008917314884490518613080652875623759460663908309369135829140204137773254011408135516737187092812588388209697036416805176286184831779945910125467423823737934475944632379524991238593952097013985394648562259886597816452815669024660257170465154297959999722533255899489096196292778430386116108069053440749172609798098777046509743030019115282253351905670418760503352277616008654327326851761671410084489662135479597061419403235762755010286075975241013273964842915146756571330207605591193457296347769260777032489271278979332616929093357929916558230665466587125254822846466292980360420737307459205352964255972268278992730637939153686420457279334894980200862788513296786385507282999530973028293157179873999483225505784146175328159014143540959190522315340971608002638786511995717564457749873410017343184395040614025573440462522210939180555090227730875845671821586191943346000</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>有了Golden_Oath，也知道n=p*q，解个方程就可以求出来p和q了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Golden_Oath = <span class="number">400042032831098007958224589201074030167511216235146696966889080122265111949126155016295896501799032251334875101500882585261911204171467951139573150807043239564581043145433814155757093989016940205116328236031283789686099217459678429270939065783626769903068201144816933538226628329294355184200590029028565011348654002192085571172863125467318356642528249715812871925525776008917314884490518613080652875623759460663908309369135829140204137773254011408135516737187092812588388209697036416805176286184831779945910125467423823737934475944632379524991238593952097013985394648562259886597816452815669024660257170465154297959999722533255899489096196292778430386116108069053440749172609798098777046509743030019115282253351905670418760503352277616008654327326851761671410084489662135479597061419403235762755010286075975241013273964842915146756571330207605591193457296347769260777032489271278979332616929093357929916558230665466587125254822846466292980360420737307459205352964255972268278992730637939153686420457279334894980200862788513296786385507282999530973028293157179873999483225505784146175328159014143540959190522315340971608002638786511995717564457749873410017343184395040614025573440462522210939180555090227730875845671821586191943346000</span></span><br><span class="line"><span class="keyword">from</span> sympy <span class="keyword">import</span> symbols, Eq, solve</span><br><span class="line"></span><br><span class="line">p, q = symbols(<span class="string">&#x27;p q&#x27;</span>)</span><br><span class="line">equation1 = Eq(p * q, n)</span><br><span class="line">equation2 = Eq((p-<span class="number">114</span>)*(p-<span class="number">514</span>)*(p+<span class="number">114</span>)*(p+<span class="number">514</span>)*(q-<span class="number">1919</span>)*(q-<span class="number">810</span>)*(q+<span class="number">1919</span>)*(q+<span class="number">810</span>), Golden_Oath)</span><br><span class="line">solutions = solve((equation1, equation2), (p, q))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;p 和 q 的解: <span class="subst">&#123;solutions&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p 和 q 的解: [(-11256874906034337229658272553494271626180719204801621165552253304119314454014247481847595578004383239651599038196432752043642616511808644606155091511313329, -12563439896413287507369191021540890661182794010085857062984791988214078294298809633469029528754549607502031091193150571585844351836163514784874848514208151), (11256874906034337229658272553494271626180719204801621165552253304119314454014247481847595578004383239651599038196432752043642616511808644606155091511313329, 12563439896413287507369191021540890661182794010085857062984791988214078294298809633469029528754549607502031091193150571585844351836163514784874848514208151)]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>有了p，q后就标准RSA解密过程抬走</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">python</span><br><span class="line">p = <span class="number">11256874906034337229658272553494271626180719204801621165552253304119314454014247481847595578004383239651599038196432752043642616511808644606155091511313329</span></span><br><span class="line">q = <span class="number">12563439896413287507369191021540890661182794010085857062984791988214078294298809633469029528754549607502031091193150571585844351836163514784874848514208151</span></span><br><span class="line">d = inverse(e, (p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">m = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># b&#x27;flag&#123;rE@L_d@m@9e_15_7h3_mo5t_au7hEn7ic_dam49E&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="圣石匕首"><a class="markdownIt-Anchor" href="#圣石匕首"></a> <strong>圣石匕首</strong></h3>
<p>一个sage文件，在sagemath中运行一下就好了</p>
<p><img src="../images/image-20250825204248328.png" alt="image-20250825204248328" /></p>
<h3 id="欧拉欧拉二进制加法欧拉函数"><a class="markdownIt-Anchor" href="#欧拉欧拉二进制加法欧拉函数"></a> 欧拉欧拉(二进制加法+欧拉函数)</h3>
<p><img src="../images/image-20250825202808414.png" alt="image-20250825202808414" /></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;flag&#123;*********&#125;&#x27;</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_prime</span>(<span class="params">bits</span>):</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p = getPrime(bits)</span><br><span class="line">        x = (<span class="number">1</span> &lt;&lt; bits) - <span class="number">1</span> ^ p</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(-<span class="number">10</span>, <span class="number">11</span>):</span><br><span class="line">            <span class="keyword">if</span> isPrime(x + i):</span><br><span class="line">                <span class="keyword">return</span> p, x + i, i</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p, q, i = get_prime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">c = <span class="built_in">pow</span>(m, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;c =&quot;</span>, c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;n =&quot;</span>, n)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;i =&quot;</span>, i)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 14859652090105683079145454585893160422247900801288656111826569181159038438427898859238993694117308678150258749913747829849091269373672489350727536945889312021893859587868138786640133976196803958879602927438349289325983895357127086714561807181967380062187404628829595784290171905916316214021661729616120643997</span></span><br><span class="line"><span class="string">n = 18104347461003907895610914021247683508445228187648940019610703551961828343286923443588324205257353157349226965840638901792059481287140055747874675375786201782262247550663098932351593199099796736521757473187142907551498526346132033381442243277945568526912391580431142769526917165011590824127172120180838162091</span></span><br><span class="line"><span class="string">i = -3</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>首先我们有 <code>x = (1 &lt;&lt; bits) - 1 ^ p</code></p>
<p>先了解一下二进制加法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = 0b1001</span><br><span class="line">b = a ^ 0b1111 = 0b0110</span><br><span class="line">a + b = 1111</span><br></pre></td></tr></table></figure>
<p>所有我们有 <code>x+p = (1 &lt;&lt; bits) - 1 </code></p>
<p><img src="../images/image-20250825205155824.png" alt="image-20250825205155824" /></p>
<p>然后求出d即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">c = <span class="number">14859652090105683079145454585893160422247900801288656111826569181159038438427898859238993694117308678150258749913747829849091269373672489350727536945889312021893859587868138786640133976196803958879602927438349289325983895357127086714561807181967380062187404628829595784290171905916316214021661729616120643997</span></span><br><span class="line">n = <span class="number">18104347461003907895610914021247683508445228187648940019610703551961828343286923443588324205257353157349226965840638901792059481287140055747874675375786201782262247550663098932351593199099796736521757473187142907551498526346132033381442243277945568526912391580431142769526917165011590824127172120180838162091</span></span><br><span class="line">i = -<span class="number">3</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">phi=n-<span class="number">2</span>**<span class="number">512</span>+<span class="number">2</span>-i</span><br><span class="line">d=gmpy2.invert(e,phi)</span><br><span class="line">m=<span class="built_in">pow</span>(c,d,n)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>
<h2 id="week5"><a class="markdownIt-Anchor" href="#week5"></a> week5</h2>
<h3 id="rsa-cmd5rsa签名"><a class="markdownIt-Anchor" href="#rsa-cmd5rsa签名"></a> <strong>RSA? cmd5!（rsa签名）</strong></h3>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">应该都了解 RSA 解密原理了吧？</span><br><span class="line"></span><br><span class="line">Alice: 你把服务器密码用 RSA 加密给我发过来吧，记得带上签名</span><br><span class="line"></span><br><span class="line">Bob: 好麻烦，还要签名，算了，直接 MD5 签名一下就好了吧！</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="comment"># 什么？你说你用md5给rsa签名了？！</span></span><br><span class="line"></span><br><span class="line">m = <span class="string">&#x27;*******&#x27;</span></span><br><span class="line"><span class="keyword">assert</span> <span class="built_in">len</span>(m) == <span class="number">7</span></span><br><span class="line">flag = <span class="string">&#x27;flag&#123;th1s_1s_my_k3y:&#x27;</span> + m + <span class="string">&#x27;0x&#x27;</span> + hashlib.sha256(m.encode()).hexdigest() + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"></span><br><span class="line">p = getStrongPrime(<span class="number">512</span>)</span><br><span class="line">q = getStrongPrime(<span class="number">512</span>)</span><br><span class="line">n = p * q</span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">d = inverse(e, phi)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_MD5</span>(<span class="params">m0</span>):</span><br><span class="line">    <span class="keyword">import</span> hashlib</span><br><span class="line">    md5_object = hashlib.md5(m0.encode())</span><br><span class="line">    md5_result = md5_object.hexdigest()</span><br><span class="line">    <span class="keyword">return</span> md5_result</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_s</span>(<span class="params">m0, d0, n0</span>):</span><br><span class="line">    hm0 = get_MD5(m0)</span><br><span class="line">    hm1 = bytes_to_long(hm0.encode())</span><br><span class="line">    s0 = <span class="built_in">pow</span>(hm1, d0, n0)</span><br><span class="line">    <span class="keyword">return</span> s0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rsa_encode</span>(<span class="params">m0, e0, n0</span>):</span><br><span class="line">    m1 = bytes_to_long(m0.encode())</span><br><span class="line">    c0 = <span class="built_in">pow</span>(m1, e0, n0)</span><br><span class="line">    <span class="keyword">return</span> c0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_flag</span>(<span class="params">m0</span>):  <span class="comment"># 请用这个函数来转m得到flag</span></span><br><span class="line">    <span class="keyword">import</span> hashlib</span><br><span class="line">    flag = <span class="string">&#x27;flag&#123;th1s_1s_my_k3y:&#x27;</span> + m0 + <span class="string">&#x27;0x&#x27;</span> + hashlib.sha256(m0.encode()).hexdigest() + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">    <span class="built_in">print</span>(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s = get_s(m, d, n)</span><br><span class="line">c = rsa_encode(flag, e, n)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;密文c =&quot;</span>, c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;签名s =&quot;</span>, s)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;公钥[n,e] =&quot;</span>, [n, e])</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">密文c = 119084320846787611587774426118526847905825678869032529318497425064970463356147909835330423466179802531093233559613714033492951177656433798856482195873924140269461792479008703758436687940228268475598134411304167494814557384094637387369282900460926092035234233538644197114822992825439656673482850515654334379332</span></span><br><span class="line"><span class="string">签名s = 5461514893126669960233658468203682813465911805334274462134892270260355037191167357098405392972668890146716863374229152116784218921275571185229135409696720018765930919309887205786492284716906060670649040459662723215737124829497658722113929054827469554157634284671989682162929417551313954916635460603628116503</span></span><br><span class="line"><span class="string">公钥[n,e] = [139458221347981983099030378716991183653410063401398496859351212711302933950230621243347114295539950275542983665063430931475751013491128583801570410029527087462464558398730501041018349125941967135719526654701663270142483830687281477000567117071676521061576952568958398421029292366101543468414270793284704549051, 65537]</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>首先</p>
<p><img src="../images/image-20250826162030399.png" alt="image-20250826162030399" /></p>
<p><img src="../images/image-20250826161259164.png" alt="image-20250826161259164" /></p>
<ul>
<li>
<p>已知签名结果 s</p>
</li>
<li>
<p>公钥 [n,e]</p>
</li>
</ul>
<p class='katex-block katex-error' title='Error: Font metrics not found for font: .'>公钥和私钥有关系：

𝑒
⋅
𝑑
≡
1
(
m
o
d
𝜑
(
𝑛
)
)
</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>已知</mtext><mi>s</mi><mo>=</mo><mo stretchy="false">(</mo><mi>h</mi><mi>m</mi><mn>1</mn><msup><mo stretchy="false">)</mo><mi>d</mi></msup><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">已知s=(hm1)^d(modn)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord cjk_fallback">已</span><span class="mord cjk_fallback">知</span><span class="mord mathnormal">s</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.149108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mord mathnormal">m</span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span></p>
<p>进行一次公钥运算：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>s</mi><mi>e</mi></msup><mo>=</mo><mo stretchy="false">(</mo><mo stretchy="false">(</mo><mi>h</mi><mi>m</mi><mn>1</mn><msup><mo stretchy="false">)</mo><mi>d</mi></msup><msup><mo stretchy="false">)</mo><mi>e</mi></msup><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">s^e=((hm1)^d)^e(modn)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7143919999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.149108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mord mathnormal">m</span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">d</span></span></span></span></span></span></span></span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span></p>
<p>又已知</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mo stretchy="false">(</mo><mi>h</mi><mi>m</mi><mn>1</mn><msup><mo stretchy="false">)</mo><mrow><mi>d</mi><mi>e</mi></mrow></msup><mo>≡</mo><mi>h</mi><mi>m</mi><mn>1</mn><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(hm1)^{de}≡hm1(modn)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.149108em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">h</span><span class="mord mathnormal">m</span><span class="mord">1</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">≡</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class="mord mathnormal">m</span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span></p>
<p>所以</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msup><mi>s</mi><mi>e</mi></msup><mo>=</mo><mi>h</mi><mi>m</mi><mn>1</mn><mo stretchy="false">(</mo><mi>m</mi><mi>o</mi><mi>d</mi><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">s^e=hm1(modn)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7143919999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">h</span><span class="mord mathnormal">m</span><span class="mord">1</span><span class="mopen">(</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span></p>
<p>因此就能求出hm1了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line">c = <span class="number">119084320846787611587774426118526847905825678869032529318497425064970463356147909835330423466179802531093233559613714033492951177656433798856482195873924140269461792479008703758436687940228268475598134411304167494814557384094637387369282900460926092035234233538644197114822992825439656673482850515654334379332</span></span><br><span class="line">s = <span class="number">5461514893126669960233658468203682813465911805334274462134892270260355037191167357098405392972668890146716863374229152116784218921275571185229135409696720018765930919309887205786492284716906060670649040459662723215737124829497658722113929054827469554157634284671989682162929417551313954916635460603628116503</span></span><br><span class="line">n =<span class="number">139458221347981983099030378716991183653410063401398496859351212711302933950230621243347114295539950275542983665063430931475751013491128583801570410029527087462464558398730501041018349125941967135719526654701663270142483830687281477000567117071676521061576952568958398421029292366101543468414270793284704549051</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">hm1=<span class="built_in">pow</span>(s,e,n)</span><br><span class="line">m_md5=long_to_bytes(hm1)</span><br><span class="line"><span class="built_in">print</span>(hm1)</span><br><span class="line"><span class="built_in">print</span>(m_md5)</span><br><span class="line"><span class="comment">#25425268828083277521312235168617211976498909227236280381829259410789486649912</span></span><br><span class="line"><span class="comment">#b&#x27;86133884de98baada58a8c4de66e15b8&#x27;</span></span><br><span class="line"><span class="comment">#hm1是m的md5值转为整数</span></span><br></pre></td></tr></table></figure>
<p>所以m的md5值就是<code>86133884de98baada58a8c4de66e15b8</code></p>
<p><img src="../images/0509ef79d6b24826ab3593ce3e972ed7.png" alt="在这里插入图片描述" /></p>
<p>完整POC：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line">c = <span class="number">119084320846787611587774426118526847905825678869032529318497425064970463356147909835330423466179802531093233559613714033492951177656433798856482195873924140269461792479008703758436687940228268475598134411304167494814557384094637387369282900460926092035234233538644197114822992825439656673482850515654334379332</span></span><br><span class="line">s = <span class="number">5461514893126669960233658468203682813465911805334274462134892270260355037191167357098405392972668890146716863374229152116784218921275571185229135409696720018765930919309887205786492284716906060670649040459662723215737124829497658722113929054827469554157634284671989682162929417551313954916635460603628116503</span></span><br><span class="line">n =<span class="number">139458221347981983099030378716991183653410063401398496859351212711302933950230621243347114295539950275542983665063430931475751013491128583801570410029527087462464558398730501041018349125941967135719526654701663270142483830687281477000567117071676521061576952568958398421029292366101543468414270793284704549051</span></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line">hm1=<span class="built_in">pow</span>(s,e,n)</span><br><span class="line">m_md5=long_to_bytes(hm1)</span><br><span class="line"><span class="built_in">print</span>(hm1)</span><br><span class="line"><span class="built_in">print</span>(m_md5)</span><br><span class="line">m=<span class="string">&quot;adm0n12&quot;</span></span><br><span class="line">flag = <span class="string">&#x27;flag&#123;th1s_1s_my_k3y:&#x27;</span> + m + <span class="string">&#x27;0x&#x27;</span> + hashlib.sha256(m.encode()).hexdigest() + <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br><span class="line"><span class="comment">#flag&#123;th1s_1s_my_k3y:adm0n120xbfab06114aa460b85135659e359fe443f9d91950ca95cbb2cbd6f88453e2b08b&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="easy_eccecc普通明文映射加密"><a class="markdownIt-Anchor" href="#easy_eccecc普通明文映射加密"></a> <strong>easy_ecc（ECC普通明文映射加密）</strong></h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> * <span class="comment"># type: ignore</span></span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = <span class="number">64408890408990977312449920805352688472706861581336743385477748208693864804529</span></span><br><span class="line">a = <span class="number">111430905433526442875199303277188510507615671079377406541731212384727808735043</span></span><br><span class="line">b = <span class="number">89198454229925288228295769729512965517404638795380570071386449796440992672131</span></span><br><span class="line">E = EllipticCurve(GF(p),[a,b])</span><br><span class="line">m = E.random_point()</span><br><span class="line">G = E.random_point()</span><br><span class="line">k = <span class="number">86388708736702446338970388622357740462258632504448854088010402300997950626097</span></span><br><span class="line">K = k * G</span><br><span class="line">r = getPrime(<span class="number">256</span>)</span><br><span class="line">c1 = m + r * K</span><br><span class="line">c2 = r * G</span><br><span class="line">c_left =bytes_to_long(flag[:<span class="built_in">len</span>(flag)//<span class="number">2</span>]) * m[<span class="number">0</span>]</span><br><span class="line">c_right = bytes_to_long(flag[<span class="built_in">len</span>(flag)//<span class="number">2</span>:]) * m[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c1 = <span class="subst">&#123;c1&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;c2 = <span class="subst">&#123;c2&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;cipher_left = <span class="subst">&#123;c_left&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;cipher_right = <span class="subst">&#123;c_right&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c1 = (10968743933204598092696133780775439201414778610710138014434989682840359444219 : 50103014985350991132553587845849427708725164924911977563743169106436852927878 : 1)</span></span><br><span class="line"><span class="string">c2 = (16867464324078683910705186791465451317548022113044260821414766837123655851895 : 35017929439600128416871870160299373917483006878637442291141472473285240957511 : 1)</span></span><br><span class="line"><span class="string">c_left = 15994601655318787407246474983001154806876869424718464381078733967623659362582</span></span><br><span class="line"><span class="string">c_right = 3289163848384516328785319206783144958342012136997423465408554351179699716569</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>之前没接触过ECC加密，特地深造了一个下午，看懂了皮毛了</p>
<p>参数都有了，一个普通明文映射，直接解密就行:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> n2s</span><br><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> getPrime,bytes_to_long,long_to_bytes</span><br><span class="line"></span><br><span class="line">p = <span class="number">64408890408990977312449920805352688472706861581336743385477748208693864804529</span></span><br><span class="line">a = <span class="number">111430905433526442875199303277188510507615671079377406541731212384727808735043</span></span><br><span class="line">b = <span class="number">89198454229925288228295769729512965517404638795380570071386449796440992672131</span></span><br><span class="line">E = EllipticCurve(GF(p),[a,b])</span><br><span class="line">k = <span class="number">86388708736702446338970388622357740462258632504448854088010402300997950626097</span></span><br><span class="line">c1 = E(<span class="number">10968743933204598092696133780775439201414778610710138014434989682840359444219</span>,<span class="number">50103014985350991132553587845849427708725164924911977563743169106436852927878</span>)</span><br><span class="line">c2 = E(<span class="number">16867464324078683910705186791465451317548022113044260821414766837123655851895</span>,<span class="number">35017929439600128416871870160299373917483006878637442291141472473285240957511</span>)</span><br><span class="line">c_left = <span class="number">15994601655318787407246474983001154806876869424718464381078733967623659362582</span></span><br><span class="line">c_right = <span class="number">3289163848384516328785319206783144958342012136997423465408554351179699716569</span></span><br><span class="line">m = c1 - k*c2</span><br><span class="line">cipher_left = c_left * inverse_mod(<span class="built_in">int</span>(m[<span class="number">0</span>]), p) % p</span><br><span class="line">cipher_right = c_right * inverse_mod(<span class="built_in">int</span>(m[<span class="number">1</span>]), p) % p</span><br><span class="line"><span class="built_in">print</span>(cipher_left, cipher_right)</span><br><span class="line">flag_left  = long_to_bytes(cipher_left)</span><br><span class="line">flag_right = long_to_bytes(cipher_right)</span><br><span class="line"></span><br><span class="line">flag_bytes = flag_left + flag_right</span><br><span class="line"><span class="built_in">print</span>(flag_bytes)</span><br></pre></td></tr></table></figure>
<p><img src="../images/image-20250826211545264.png" alt="image-20250826211545264" /></p>
<h3 id="学以致用多项式求解"><a class="markdownIt-Anchor" href="#学以致用多项式求解"></a> <strong>学以致用(多项式求解)</strong></h3>
<p>—— 帮帮我，sagemath 先生，TAT</p>
<p>—— NewStar，我来助你！</p>
<p><a target="_blank" rel="noopener" href="http://users.ece.cmu.edu/~reiter/papers/1996/Eurocrypt.pdf">http://users.ece.cmu.edu/~reiter/papers/1996/Eurocrypt.pdf</a></p>
<p><a target="_blank" rel="noopener" href="https://doc.sagemath.org/html/en/reference/">https://doc.sagemath.org/html/en/reference/</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pad</span>(<span class="params">msg, nbits</span>):</span><br><span class="line">    <span class="comment"># pad了一下，仔细看看，别好不容易解出来了却没看到flag👼</span></span><br><span class="line">    pad_length = nbits - <span class="built_in">len</span>(msg) * <span class="number">8</span> - <span class="number">16</span></span><br><span class="line">    <span class="keyword">assert</span> pad_length &gt;= <span class="number">0</span></span><br><span class="line">    pad = random.getrandbits(pad_length).to_bytes((pad_length + <span class="number">7</span>) // <span class="number">8</span>, <span class="string">&quot;big&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> pad[:<span class="built_in">len</span>(pad)//<span class="number">2</span>] + <span class="string">b&quot;*&quot;</span> + msg + <span class="string">b&quot;*&quot;</span> + pad[<span class="built_in">len</span>(pad)//<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    p = getPrime(<span class="number">1024</span>)</span><br><span class="line">    q = getPrime(<span class="number">1024</span>)</span><br><span class="line">    n = p*q</span><br><span class="line">    e = <span class="number">3</span></span><br><span class="line">    Nbits = <span class="number">2048</span></span><br><span class="line">    flag = <span class="string">b&#x27;flag&#123;?????&#125;&#x27;</span></span><br><span class="line">    gift = <span class="string">b&#x27;GoOd_byE_nEw_5t@r&#x27;</span></span><br><span class="line">    </span><br><span class="line">    flag1 = bytes_to_long(pad(flag[:<span class="built_in">len</span>(flag)//<span class="number">2</span>], Nbits-<span class="number">1</span>))</span><br><span class="line">    flag2 = bytes_to_long(pad(flag[<span class="built_in">len</span>(flag)//<span class="number">2</span>:], Nbits-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;n =&#x27;</span>,n)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;c1 =&#x27;</span>, <span class="built_in">pow</span>(flag1, e, n))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;c2 =&#x27;</span>, <span class="built_in">pow</span>(flag2, e, n))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;c3 =&#x27;</span>, <span class="built_in">pow</span>(flag1 + flag2 + bytes_to_long(gift), e, n))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">n = 17072342544150714171879132077494975311237876365187751353863158074020024719122755004761547735987417065592254800869192615807192722193500063611855839293567948232939959753821265552288663615847715716482887552271575844394350597695771100384136647573934496089812758071894172682439278191678102960768874456521879228612030147515967603129172838399997929502420254427798644285909855414606857035622716853274887875327854429218889083561315575947852542496274004905526475639809955792541187225767181054156589100604740904889686749740630242668885218256352895323426975708439512538106136364251265896292820030381364013059573189847777297569447</span></span><br><span class="line"><span class="string">c1 = 8101607280875746172766350224846108949565038929638360896232937975003150339090901182469578468557951846695946788093600030667125114278821199071782965501023811374181199570231982146140558093531414276709503788909827053368206185816004954186722115752214445121933300663507795347827581212475501366473409732970429363451582182754416452300394502623461416323078625518733218381660019606631159370121924340238446442870526675388637840247597153414432589505667533462640554984002009801576552636432097311654946821118444391557368410974979376926427631136361612166670672126393485023374083079458502529640435635667010258110833498681992307452573</span></span><br><span class="line"><span class="string">c2 = 14065316670254822235992102489645154264346717769174145550276846121970418622727279704820311564029018067692096462028836081822787148419633716320984336571241963063899868344606864544582504200779938815500203097282542495029462627888080005688408399148971228321637101593575245562307799087481654331283466914448740771421597528473762480363235531826325289856465115044393153437766069365345615753845871983173987642746989559569021189014927911398163825342784515926151087560415374622389991673648463353143338452444851518310480115818005343166067775633021475978188567581820594153290828348099804042221601767330439504722881619147742710013878</span></span><br><span class="line"><span class="string">c3 = 8094336015065392504689373372598739049074197380146388624166244791783464194652108498071001125262374720857829973449322589841225625661419126346483855290185428811872962549590383450801103516360026351074061702370835578483728260907424050069246549733800397741622131857548326468990903316013060783020272342924805005685309618377803255796096301560780471163963183261626005358125719453918037250566140850975432188309997670739064455030447411193814358481031511873409200036846039285091561677264719855466015739963580639810265153141785946270781617266125399412714450669028767459800001425248072586059267446605354915948603996477113109045600</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>首先需要先求出d</p>
<p>我们现在就算要求下面三个多项式：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>f</mi><mi>l</mi><mi>a</mi><mi>g</mi><msup><mn>1</mn><mn>3</mn></msup><mo>−</mo><mi>c</mi><mn>1</mn><mo>=</mo><mn>0</mn><mi>m</mi><mi>o</mi><mi>d</mi><mi>N</mi><mspace linebreak="newline"></mspace><mi>f</mi><mi>l</mi><mi>a</mi><mi>g</mi><msup><mn>2</mn><mn>3</mn></msup><mo>−</mo><mi>c</mi><mn>2</mn><mo>=</mo><mn>0</mn><mi>m</mi><mi>o</mi><mi>d</mi><mi>N</mi><mspace linebreak="newline"></mspace><mo stretchy="false">(</mo><mi>f</mi><mi>l</mi><mi>a</mi><mi>g</mi><mn>1</mn><mo>+</mo><mi>f</mi><mi>l</mi><mi>a</mi><mi>g</mi><mn>2</mn><mo>+</mo><mi>g</mi><mi>i</mi><mi>f</mi><mi>t</mi><msup><mo stretchy="false">)</mo><mn>3</mn></msup><mo>−</mo><mi>c</mi><mn>3</mn><mo>=</mo><mn>0</mn><mi>m</mi><mi>o</mi><mi>d</mi><mi>N</mi></mrow><annotation encoding="application/x-tex">flag1^3 -c1 =0 mod N\\
flag2^3 -c2 =0 mod N\\
(flag1+flag2+gift)^3 -c3 =0 mod N
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0585479999999998em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord">1</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1.0585479999999998em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span><span class="mspace newline"></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mord mathnormal">a</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord">2</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1141079999999999em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mord mathnormal">t</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641079999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">3</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord mathnormal">c</span><span class="mord">3</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord">0</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">d</span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span></span></p>
<p>根据题目提示sagemath，想到用**groebner_basis()**这个函数</p>
<p>groebner_basis()这个函数可以求出多项式的解来</p>
<p>原理我还不清楚，只会用：</p>
<p><strong>定义一个多项式环：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x, y = PolynomialRing(Zmod(n), <span class="string">&#x27;x, y&#x27;</span>).gens()</span><br></pre></td></tr></table></figure>
<p><img src="../images/image-20250826221440757.png" alt="image-20250826221440757" /></p>
<p><strong>构造多项式：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">f1 = x^3 - c1</span><br><span class="line">f2 = y^3 - c2</span><br><span class="line">f3 = (x + y + bytes_to_long(gift))^3 - c3</span><br></pre></td></tr></table></figure>
<p><strong>求 Groebner Basis：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gb = Ideal(f1, f2, f3).groebner_basis()</span><br></pre></td></tr></table></figure>
<p><code>Ideal(f1, f2, f3)</code>：把这三个多项式生成一个理想（就是多项式集合，封闭于加法和乘以多项式）。</p>
<p><code>.groebner_basis()</code>：计算这个理想的 <strong>Groebner Basis</strong>（格罗布纳基）。</p>
<p><strong>Groebner Basis 的作用：</strong></p>
<ul>
<li>它能把多变量多项式方程组化简成“阶梯式”形式。</li>
<li>通常得到的基 <code>gb</code>：
<ol>
<li>第一条只含一个变量（比如 x）</li>
<li>第二条只含另一个变量（比如 y）</li>
</ol>
</li>
<li>这样就可以直接解出每个变量的值。</li>
</ul>
<p><strong>拿出结果：</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">f1, f2 = gb</span><br><span class="line">flag1 = <span class="built_in">int</span>(-f1.coefficients()[<span class="number">1</span>])</span><br><span class="line">flag2 = <span class="built_in">int</span>(-f2.coefficients()[<span class="number">1</span>])</span><br></pre></td></tr></table></figure>
<ul>
<li><code>f1</code> 和 <code>f2</code> 此时是化简后的多项式，例如：</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">f1: x + something = 0</span><br><span class="line">f2: y + something = 0</span><br></pre></td></tr></table></figure>
<ul>
<li><code>f1.coefficients()[1]</code> 取多项式中的线性系数，取负号得到 <code>flag1</code> 的整数表示。</li>
<li><code>flag2</code> 同理。</li>
</ul>
<blockquote>
<p>简单来说，这一步就是把经过 Groebner Basis 化简后的多项式直接“解出来”，得到 flag1 和 flag2 对应的整数。</p>
</blockquote>
<p>完整exp:<br />
#sage</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes, bytes_to_long</span><br><span class="line"></span><br><span class="line">n = <span class="number">17072342544150714171879132077494975311237876365187751353863158074020024719122755004761547735987417065592254800869192615807192722193500063611855839293567948232939959753821265552288663615847715716482887552271575844394350597695771100384136647573934496089812758071894172682439278191678102960768874456521879228612030147515967603129172838399997929502420254427798644285909855414606857035622716853274887875327854429218889083561315575947852542496274004905526475639809955792541187225767181054156589100604740904889686749740630242668885218256352895323426975708439512538106136364251265896292820030381364013059573189847777297569447</span></span><br><span class="line">c1 = <span class="number">8101607280875746172766350224846108949565038929638360896232937975003150339090901182469578468557951846695946788093600030667125114278821199071782965501023811374181199570231982146140558093531414276709503788909827053368206185816004954186722115752214445121933300663507795347827581212475501366473409732970429363451582182754416452300394502623461416323078625518733218381660019606631159370121924340238446442870526675388637840247597153414432589505667533462640554984002009801576552636432097311654946821118444391557368410974979376926427631136361612166670672126393485023374083079458502529640435635667010258110833498681992307452573</span></span><br><span class="line">c2 = <span class="number">14065316670254822235992102489645154264346717769174145550276846121970418622727279704820311564029018067692096462028836081822787148419633716320984336571241963063899868344606864544582504200779938815500203097282542495029462627888080005688408399148971228321637101593575245562307799087481654331283466914448740771421597528473762480363235531826325289856465115044393153437766069365345615753845871983173987642746989559569021189014927911398163825342784515926151087560415374622389991673648463353143338452444851518310480115818005343166067775633021475978188567581820594153290828348099804042221601767330439504722881619147742710013878</span></span><br><span class="line">c3 = <span class="number">8094336015065392504689373372598739049074197380146388624166244791783464194652108498071001125262374720857829973449322589841225625661419126346483855290185428811872962549590383450801103516360026351074061702370835578483728260907424050069246549733800397741622131857548326468990903316013060783020272342924805005685309618377803255796096301560780471163963183261626005358125719453918037250566140850975432188309997670739064455030447411193814358481031511873409200036846039285091561677264719855466015739963580639810265153141785946270781617266125399412714450669028767459800001425248072586059267446605354915948603996477113109045600</span></span><br><span class="line">gift = <span class="string">b&#x27;GoOd_byE_nEw_5t@r&#x27;</span></span><br><span class="line"></span><br><span class="line">x, y = PolynomialRing(Zmod(n), <span class="string">&#x27;x, y&#x27;</span>).gens()</span><br><span class="line">f1 = x**<span class="number">3</span> - c1</span><br><span class="line">f2 = y**<span class="number">3</span> - c2</span><br><span class="line">f3 = (x + y + bytes_to_long(gift))**<span class="number">3</span> - c3</span><br><span class="line"></span><br><span class="line">gb = Ideal(f1, f2, f3).groebner_basis()</span><br><span class="line">f1, f2 = gb</span><br><span class="line">flag1 = <span class="built_in">int</span>(-f1.coefficients()[<span class="number">1</span>])</span><br><span class="line">flag2 = <span class="built_in">int</span>(-f2.coefficients()[<span class="number">1</span>])</span><br><span class="line"><span class="comment"># 出题的时候加了给pad，大家得注意一下，flag在一堆trash中间，别做出了却没看见flag</span></span><br><span class="line"><span class="built_in">print</span>((long_to_bytes(flag1)).split(<span class="string">b&#x27;*&#x27;</span>)[<span class="number">2</span>]+(long_to_bytes(flag2).split(<span class="string">b&#x27;*&#x27;</span>)[<span class="number">1</span>]))</span><br><span class="line"><span class="comment"># b&#x27;flag&#123;W1Sh_you_Bec0me_an_excelL3nt_crypt0G2@pher&#125;&#x27;</span></span><br></pre></td></tr></table></figure>
<p><strong>Groebner Basis的使用条件：</strong></p>
<p><strong>多项式方程</strong></p>
<ul>
<li>你必须有一个方程组，每个方程都是多项式形式（变量的幂次是整数）。</li>
<li>例如 <code>x^3 - c1 = 0</code> 或 <code>(x + y + z)^3 - c2 = 0</code>。</li>
<li>对于非多项式方程（比如带 sin/cos/log 的方程），Groebner Basis 不适用。</li>
</ul>
<p><strong>变量数量有限</strong></p>
<ul>
<li>Groebner Basis 的计算复杂度随变量数和方程次数急剧增长。</li>
<li>实际上，多于 5-6 个高次变量时，计算可能变得非常慢。</li>
</ul>
<p><strong>目标是代数解或简化方程</strong></p>
<ul>
<li>它能让你把多元高次方程组简化成单变量方程，方便直接解。</li>
<li>不能直接用于数值近似解，更多用于<strong>符号求解</strong>。</li>
</ul>
<p><strong>多变量环或域</strong></p>
<ul>
<li>
<p>可以在任意域上使用，比如整数域、有限域、实数域（符号计算），或者模运算下的有限域（Zmod(n)）。</p>
</li>
<li>
<p>在 RSA 这种模 n 的整数域下是典型用法。</p>
</li>
</ul>
<p><strong>不是所有多项式都适合</strong></p>
<ul>
<li>如果方程组变量过多、次数很高，计算 Groebner Basis 可能会爆内存或永远算不完。</li>
<li>如果方程里有非多项式函数（比如指数、对数、三角函数），Groebner Basis 就不适用。</li>
<li>对于大规模 RSA，通常只在小指数攻击、模小范围的线性组合时使用。</li>
</ul>
<h3 id="没-e-也能玩dpdq泄露"><a class="markdownIt-Anchor" href="#没-e-也能玩dpdq泄露"></a> <strong>没 e 也能玩(dp,dq泄露)</strong></h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">1024</span>)</span><br><span class="line">q = getPrime(<span class="number">1024</span>)</span><br><span class="line">d = inverse(<span class="number">65537</span>,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line">dp = d %(p-<span class="number">1</span>)</span><br><span class="line">dq = d%(q-<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c=<span class="subst">&#123;<span class="built_in">pow</span>(bytes_to_long(flag),e,p*q)&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;p=<span class="subst">&#123;p&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;q=<span class="subst">&#123;q&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;dp=<span class="subst">&#123;dp&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;dq=<span class="subst">&#123;dq&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c=312026920216195772014255984174463085443866592575942633449581804171108045852080517840578408476885673600123673447592477875543106559822653280458539889975125069364584140981069913341705738633426978886491359036285144974311751490792757751756044409664421663980721578870582548395096887840688928684149014816557276765747135567714257184475027270111822159712532338590457693333403200971556224662094381891648467959054115723744963414673861964744567056823925630723343002325605154661959863849738333074326769879861280895388423162444746726568892877802824353858845944856881876742211956986853244518521508714633279380808950337611574412909</span></span><br><span class="line"><span class="string">p=108043725609186781791705090463399988837848128384507136697546885182257613493145758848215714322999196482303958182639388180063206708575175264502030010971971799850889123915580518613554382722069874295016841596099030496486069157061211091761273568631799006187376088457421848367280401857536410610375012371577177832001</span></span><br><span class="line"><span class="string">q=121590551121540247114817509966135120751936084528211093275386628666641298457070126234836053337681325952068673362753408092990553364818851439157868686131416391201519794244659155411228907897025948436021990520853498462677797392855335364006924106615008646396883330251028071418465977013680888333091554558623089051503</span></span><br><span class="line"><span class="string">dp=11282958604593959665264348980446305500804623200078838572989469798546944577064705030092746827389207634235443944672230537015008113180165395276742807804632116181385860873677969229460704569172318227491268503039531329141563655811632035522134920788501646372986281785901019732756566066694831838769040155501078857473</span></span><br><span class="line"><span class="string">dq=46575357360806054039250786123714177813397065260787208532360436486982363496441528434309234218672688812437737096579970959403617066243685956461527617935564293219447837324227893212131933165188205281564552085623483305721400518031651417947568896538797580895484369480168587284879837144688420597737619751280559493857</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>很常见的dp,dq泄露题：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># dp=d mod(p-1)</span></span><br><span class="line"><span class="comment"># dq=d mod(q-1)</span></span><br><span class="line"><span class="comment"># 即</span></span><br><span class="line"><span class="comment"># dp=d%(p-1)</span></span><br><span class="line"><span class="comment"># dq=d%(q-1)</span></span><br><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p = <span class="number">108043725609186781791705090463399988837848128384507136697546885182257613493145758848215714322999196482303958182639388180063206708575175264502030010971971799850889123915580518613554382722069874295016841596099030496486069157061211091761273568631799006187376088457421848367280401857536410610375012371577177832001</span></span><br><span class="line">q = <span class="number">121590551121540247114817509966135120751936084528211093275386628666641298457070126234836053337681325952068673362753408092990553364818851439157868686131416391201519794244659155411228907897025948436021990520853498462677797392855335364006924106615008646396883330251028071418465977013680888333091554558623089051503</span></span><br><span class="line">dp = <span class="number">11282958604593959665264348980446305500804623200078838572989469798546944577064705030092746827389207634235443944672230537015008113180165395276742807804632116181385860873677969229460704569172318227491268503039531329141563655811632035522134920788501646372986281785901019732756566066694831838769040155501078857473</span></span><br><span class="line">dq = <span class="number">46575357360806054039250786123714177813397065260787208532360436486982363496441528434309234218672688812437737096579970959403617066243685956461527617935564293219447837324227893212131933165188205281564552085623483305721400518031651417947568896538797580895484369480168587284879837144688420597737619751280559493857</span></span><br><span class="line">c = <span class="number">312026920216195772014255984174463085443866592575942633449581804171108045852080517840578408476885673600123673447592477875543106559822653280458539889975125069364584140981069913341705738633426978886491359036285144974311751490792757751756044409664421663980721578870582548395096887840688928684149014816557276765747135567714257184475027270111822159712532338590457693333403200971556224662094381891648467959054115723744963414673861964744567056823925630723343002325605154661959863849738333074326769879861280895388423162444746726568892877802824353858845944856881876742211956986853244518521508714633279380808950337611574412909</span></span><br><span class="line"></span><br><span class="line">I = gmpy2.invert(q,p)</span><br><span class="line">mp = <span class="built_in">pow</span>(c,dp,p)               <span class="comment">#求幂取模运算, mp = c^dp % p</span></span><br><span class="line">mq = <span class="built_in">pow</span>(c,dq,q)               <span class="comment">#求幂取模运算, mq = c^dp % q</span></span><br><span class="line"></span><br><span class="line">m = (((mp-mq)*I)%p)*q+mq       <span class="comment">#求明文公式</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">hex</span>(m))          <span class="comment">#转为十六进制</span></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;明文文本:&quot;</span>, <span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(m)[<span class="number">2</span>:]).decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"><span class="keyword">except</span> UnicodeDecodeError:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;无法解码为有效的文本&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#0x666c61677b4e6f5f636f757273655f655f63616e5f706c61797d</span></span><br><span class="line"><span class="comment">#明文文本: flag&#123;No_course_e_can_play&#125;</span></span><br></pre></td></tr></table></figure>
<p>但后面来又看了一下，这e不是也有吗，也可以直接解了。。。</p>
<h3 id="格格你好棒格攻击"><a class="markdownIt-Anchor" href="#格格你好棒格攻击"></a> <strong>格格你好棒(格攻击)</strong></h3>
<p>连 n 都没有给的 RSA？！！！快去求救格哥哥！</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">flag = <span class="string">b&#x27;******&#x27;</span></span><br><span class="line">m = bytes_to_long(flag)</span><br><span class="line"></span><br><span class="line">a = getPrime(<span class="number">1024</span>)</span><br><span class="line">b = getPrime(<span class="number">1536</span>)</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">q = getPrime(<span class="number">512</span>)</span><br><span class="line">r = random.randint(<span class="number">2</span>**<span class="number">8</span>, <span class="number">2</span>**<span class="number">9</span>)</span><br><span class="line"><span class="keyword">assert</span> ((p+<span class="number">2</span>*r) * <span class="number">3</span>*a + q) % b &lt; <span class="number">70</span></span><br><span class="line"></span><br><span class="line">c = <span class="built_in">pow</span>(m, <span class="number">0x10001</span>, p*q)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c =&#x27;</span>, c)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;a =&#x27;</span>, a)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;b =&#x27;</span>, b)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c = 75671328500214475056134178451562126288749723392201857886683373274067151096013132141603734799638338446362190819013087028001291030248155587072037662295281180020447012070607162188511029753418358484745755426924178896079516327814868477319474776976247356213687362358286132623490797882893844885783660230132191533753</span></span><br><span class="line"><span class="string">a = 99829685822966835958276444400403912618712610766908190376329921929407293564120124118477505585269077089315008380226830398574538050051718929826764449053677947419802792746249036134153510802052121734874555372027104653797402194532536147269634489642315951326590902954822775489385580372064589623985262480894316345817</span></span><br><span class="line"><span class="string">b = 2384473327543107262477269141248562917518395867365960655318142892515553817531439357316940290934095375085624218120779709239118821966188906173260307431682367028597612973683887401344727494920856592020970209197406324257478251502340099862501536622889923455273016634520507179507645734423860654584092233709560055803703801064153206431244982586989154685048854436858839309457140702847482240801158808592615931654823643778920270174913454238149949865979522520566288822366419746</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<p>关注断言<code>((p+2*r) * 3*a + q) % b &lt; 70</code></p>
<p>结果是一个小于70的数，相当于已知（爆破很快的），那么可以设成x，就可以写出下面这个样子</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mn>3</mn><mi>a</mi><mo stretchy="false">(</mo><mi>p</mi><mo>+</mo><mn>2</mn><mi>r</mi><mo stretchy="false">)</mo><mo>+</mo><mi>q</mi><mo>=</mo><mi>k</mi><mo>×</mo><mi>b</mi><mo>+</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">3a(p+2r)+q=k\times b+x
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">3</span><span class="mord mathnormal">a</span><span class="mopen">(</span><span class="mord mathnormal">p</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathnormal">b</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">x</span></span></span></span></span></p>
<p>等学了格密码再来。。。</p>

      
    </div>
    <footer class="article-footer">
      
      
      
      
      
      
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item" data-aos="zoom-in"><a class="article-tag-list-link" href="/tags/crypto/" rel="tag">crypto</a></li></ul>


    </footer>
  </div>
  
  <nav id="article-nav" data-aos="fade-up">
    
      <div class="article-nav-link-wrap article-nav-link-left">
        
          
          
            <img data-src="/images/background-2.jpg" data-sizes="auto" alt="[NewStarCTF 公开赛赛道]multiSQL" class="lazyload">
          
        
        <a href="/2025/06/12/%5BNewStarCTF%20%E5%85%AC%E5%BC%80%E8%B5%9B%E8%B5%9B%E9%81%93%5DmultiSQL/"></a>
        <div class="article-nav-caption">前一篇</div>
        <h3 class="article-nav-title">
          
            [NewStarCTF 公开赛赛道]multiSQL
          
        </h3>
      </div>
    
    
    <div class="article-nav-link-wrap article-nav-link-right">
      
        
        
          <img data-src="/images/bizhi1.png" data-sizes="auto" alt="[D3CTF 2019]EzUpload" class="lazyload">
        
      
      <a href="/2025/06/11/%5BD3CTF%202019%5DEzUpload/"></a>
      <div class="article-nav-caption">后一篇</div>
      <h3 class="article-nav-title">
        
          [D3CTF 2019]EzUpload
        
      </h3>
    </div>
    
  </nav>


</article>






</section>
        </div>
        
        
        <footer id="footer">
  <div style="width: 100%; overflow: hidden">
    <div class="footer-line"></div>
  </div>
  <div id="footer-info">
    
    <div>
      <span class="icon-copyright"></span>
      2020-2025
      <span class="footer-info-sep rotate"></span>
      FuB0Y
    </div>
    
      <div>
        基于&nbsp;<a href="https://hexo.io/" rel="noopener external nofollow noreferrer" target="_blank">Hexo</a>&nbsp;
        Theme.<a href="https://github.com/D-Sketon/hexo-theme-reimu" rel="noopener external nofollow noreferrer" target="_blank">Reimu</a>
      </div>
    
    
      <div>
        <span class="icon-brush"></span>
        284k
        &nbsp;|&nbsp;
        <span class="icon-coffee"></span>
        20:48
      </div>
    
    
    
    
      <div>
        <span class="icon-eye"></span>
        <span id="busuanzi_container_site_pv">总访问量&nbsp;<span id="busuanzi_value_site_pv"></span></span>
        &nbsp;|&nbsp;
        <span class="icon-user"></span>
        <span id="busuanzi_container_site_uv">总访客量&nbsp;<span id="busuanzi_value_site_uv"></span></span>
      </div>
    
  </div>
</footer>

        
          <div class="sidebar-top">
            <div class="sidebar-top-taichi rotate"></div>
            <div class="arrow-up"></div>
          </div>
        
        <div id="mask" class="hide"></div>
      </div>
      <nav id="mobile-nav">
  <div class="sidebar-wrap">
    
      <div class="sidebar-toc-sidebar"><div class="sidebar-toc">
  <h3 class="toc-title">文章目录</h3>
  <div class="sidebar-toc-wrapper toc-div-class" >
      
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#week1"><span class="toc-number">1.</span> <span class="toc-text"> week1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#base-16%E8%BF%9B%E5%88%B6base%E8%A7%A3%E5%AF%86"><span class="toc-number">1.1.</span> <span class="toc-text"> Base (16进制+base解密）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#strange-king"><span class="toc-number">1.2.</span> <span class="toc-text"> Strange King</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#xor"><span class="toc-number">1.3.</span> <span class="toc-text"> xor</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E7%9C%BC%E7%A7%92%E4%BA%86-rsa"><span class="toc-number">1.4.</span> <span class="toc-text"> 一眼秒了 （RSA）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week2"><span class="toc-number">2.</span> <span class="toc-text"> week2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#just-one-and-more-than-tworsa"><span class="toc-number">2.1.</span> <span class="toc-text"> Just one and more than two（RSA）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#since-you-konw-something%E5%BC%82%E6%88%96-%E7%88%86%E7%A0%B4"><span class="toc-number">2.2.</span> <span class="toc-text"> Since you konw something(异或 爆破)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8C%B6%E9%87%8C%E8%8C%B6%E6%B0%94tea%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95"><span class="toc-number">2.3.</span> <span class="toc-text"> 茶里茶气（TEA加密算法）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%99%E6%98%AF%E5%87%A0%E6%AC%A1%E6%96%B9%E7%96%91%E6%83%91"><span class="toc-number">2.4.</span> <span class="toc-text"> 这是几次方？疑惑！</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%95%E4%B8%80%E5%BC%82%E6%88%96%E7%AC%A6%E5%8F%B7%E7%9A%84%E8%BF%90%E7%AE%97%E4%BC%98%E5%85%88%E7%BA%A7"><span class="toc-number">2.4.1.</span> <span class="toc-text"> 法一：(异或符号的运算优先级)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%95%E4%BA%8Cfactor%E5%88%86%E8%A7%A3n"><span class="toc-number">2.4.2.</span> <span class="toc-text"> 法二：factor分解n</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week3"><span class="toc-number">3.</span> <span class="toc-text"> week3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8D%E7%94%A8%E8%B0%A2%E5%96%B5aes%E7%9A%84cbc%E5%92%8Cecb%E6%A8%A1%E5%BC%8F"><span class="toc-number">3.1.</span> <span class="toc-text"> 不用谢喵（AES的CBC和ECB模式）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8A%A0%E5%AF%86%E7%AE%97%E6%B3%95"><span class="toc-number">3.1.1.</span> <span class="toc-text"> 加密算法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98"><span class="toc-number">3.1.2.</span> <span class="toc-text"> 解题</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%A4%E4%B8%AA%E9%BB%84%E9%B9%82%E9%B8%A3%E7%BF%A0%E6%9F%B3-%E5%85%B3%E8%81%94%E4%BF%A1%E6%81%AF%E6%94%BB%E5%87%BB-half-gcd%E7%AE%97%E6%B3%95"><span class="toc-number">3.2.</span> <span class="toc-text"> 两个黄鹂鸣翠柳 （关联信息攻击 Half-gcd算法）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%85%E4%BA%8B%E6%96%B0%E7%BC%96-1vigenere%E5%8A%A0%E5%AF%86"><span class="toc-number">3.3.</span> <span class="toc-text"> **故事新编 1(Vigenere加密) **</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%85%E4%BA%8B%E6%96%B0%E7%BC%96-2%E8%87%AA%E5%8A%A8%E5%AF%86%E9%92%A5%E5%8A%A0%E5%AF%86vigenere"><span class="toc-number">3.4.</span> <span class="toc-text"> 故事新编 2（自动密钥加密+Vigenere）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B2%A1e%E8%BF%99%E8%83%BD%E7%8E%A9%E7%A6%BB%E6%95%A3%E5%AF%B9%E6%95%B0"><span class="toc-number">3.5.</span> <span class="toc-text"> 没e这能玩(离散对数)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week4"><span class="toc-number">4.</span> <span class="toc-text"> week4</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BF%B1%E4%BB%A5%E6%88%91%E4%B9%8B%E5%90%8D%E7%BB%B4%E7%BA%B3%E6%94%BB%E5%87%BB"><span class="toc-number">4.1.</span> <span class="toc-text"> 俱以我之名(维纳攻击)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86"><span class="toc-number">4.1.1.</span> <span class="toc-text"> 前置知识</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%B4%E7%BA%B3%E6%94%BB%E5%87%BB%E8%84%9A%E6%9C%ACsage"><span class="toc-number">4.1.2.</span> <span class="toc-text"> 维纳攻击脚本(sage)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98-2"><span class="toc-number">4.1.3.</span> <span class="toc-text"> 解题</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A3%E7%9F%B3%E5%8C%95%E9%A6%96"><span class="toc-number">4.2.</span> <span class="toc-text"> 圣石匕首</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AC%A7%E6%8B%89%E6%AC%A7%E6%8B%89%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%8A%A0%E6%B3%95%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0"><span class="toc-number">4.3.</span> <span class="toc-text"> 欧拉欧拉(二进制加法+欧拉函数)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#week5"><span class="toc-number">5.</span> <span class="toc-text"> week5</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#rsa-cmd5rsa%E7%AD%BE%E5%90%8D"><span class="toc-number">5.1.</span> <span class="toc-text"> RSA? cmd5!（rsa签名）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#easy_eccecc%E6%99%AE%E9%80%9A%E6%98%8E%E6%96%87%E6%98%A0%E5%B0%84%E5%8A%A0%E5%AF%86"><span class="toc-number">5.2.</span> <span class="toc-text"> easy_ecc（ECC普通明文映射加密）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%A6%E4%BB%A5%E8%87%B4%E7%94%A8%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%B1%82%E8%A7%A3"><span class="toc-number">5.3.</span> <span class="toc-text"> 学以致用(多项式求解)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B2%A1-e-%E4%B9%9F%E8%83%BD%E7%8E%A9dpdq%E6%B3%84%E9%9C%B2"><span class="toc-number">5.4.</span> <span class="toc-text"> 没 e 也能玩(dp,dq泄露)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%BC%E6%A0%BC%E4%BD%A0%E5%A5%BD%E6%A3%92%E6%A0%BC%E6%94%BB%E5%87%BB"><span class="toc-number">5.5.</span> <span class="toc-text"> 格格你好棒(格攻击)</span></a></li></ol></li></ol>
      
  </div>
</div>
</div>
      <div class="sidebar-common-sidebar hidden"><div class="sidebar-author">
  <img data-src="/avatar/avatar.jpg" data-sizes="auto" alt="FuB0Y" class="lazyload">
  <div class="sidebar-author-name">FuB0Y</div>
  <div class="sidebar-description">世所谓英雄者，不以挫抑而灰心，不以失败而退怯</div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>文章</div>
    <div class="sidebar-state-number">186</div>
  </div>
  <div class="sidebar-state-category">
    <div>分类</div>
    <div class="sidebar-state-number">4</div>
  </div>
  <div class="sidebar-state-tag">
    <div>标签</div>
    <div class="sidebar-state-number">179</div>
  </div>
</div>
<div class="sidebar-social">
  
</div>
<div class="sidebar-menu">
  
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/" aria-label="首页"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">首页</div>
      </div>
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/archives" aria-label="归档"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">归档</div>
      </div>
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/about" aria-label="关于"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">关于</div>
      </div>
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/friend" aria-label="友链"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">友链</div>
      </div>
    
  
</div>
</div>
    
  </div>
  
    <div class="sidebar-btn-wrapper">
      <div class="sidebar-toc-btn current"></div>
      <div class="sidebar-common-btn"></div>
    </div>
  
</nav>

    </div>
    
    
<script src="https://npm.webcache.cn/lazysizes@5.3.2/lazysizes.min.js" integrity="sha384-3gT&#x2F;vsepWkfz&#x2F;ff7PpWNUeMzeWoH3cDhm&#x2F;A8jM7ouoAK0&#x2F;fP&#x2F;9bcHHR5kHq2nf+e" crossorigin="anonymous"></script>


<script src="https://npm.webcache.cn/clipboard@2.0.11/dist/clipboard.min.js" integrity="sha384-J08i8An&#x2F;QeARD9ExYpvphB8BsyOj3Gh2TSh1aLINKO3L0cMSH2dN3E22zFoXEi0Q" crossorigin="anonymous"></script>



<script src="/js/script.js"></script>



  
<script src="/js/aos.js"></script>

  <script>
    var aosInit = () => {
      AOS.init({
        duration: 1000,
        easing: "ease",
        once: true,
        offset: 50,
      });
    };
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', aosInit);
    } else {
      aosInit();
    }
  </script>



<script src="/js/pjax_script.js" data-pjax></script>







  
<script src="https://npm.webcache.cn/mouse-firework@0.0.6/dist/index.umd.js" integrity="sha384-vkGvf25gm1C1PbcoD5dNfc137HzNL&#x2F;hr1RKA5HniJOaawtvUmH5lTVFgFAruE9Ge" crossorigin="anonymous"></script>

  <script>
    window.firework && window.firework(JSON.parse('{"excludeElements":["a","button"],"particles":[{"shape":"circle","move":["emit"],"easing":"easeOutExpo","colors":["#ff5252","#ff7c7c","#ffafaf","#ffd0d0"],"number":20,"duration":[1200,1800],"shapeOptions":{"radius":[16,32],"alpha":[0.3,0.5]}},{"shape":"circle","move":["diffuse"],"easing":"easeOutExpo","colors":["#ff0000"],"number":1,"duration":[1200,1800],"shapeOptions":{"radius":20,"alpha":[0.2,0.5],"lineWidth":6}}]}'))
  </script>










<div id="lazy-script">
  <div>
    
      
      
      <script data-pjax>
        window.REIMU_POST = {
          author: "FuB0Y",
          title: "Crypto复现",
          url: "http://example.com/2025/06/12/NewStarCTF-Crypto%E5%A4%8D%E7%8E%B0/",
          excerpt: "",
          description: "",
          stripContent: " week1  Base (16进制+base解密） 给了我们一串字符串 先16进制解密一次 再base32+base64解密一次  Strange King 123题目描述：某喜欢抽锐刻 5 的皇帝想每天进步一些，直到他娶了个模，回到原点，全部白给😅 这是他最后留下的讯息：`ksjr&amp;#123;EcxvpdErSvcDgdgEzxqjql&amp;#125;`，flag 包裹的是可读的明文 根据ksjr对应flag可以发现 f=k-5 l=s-7 … 对应偏移量5,7,9,11 而且需要%26 脚本",
          date: "Thu Jun 12 2025 17:12:23 GMT+0800",
          updated: "Tue Aug 26 2025 22:42:13 GMT+0800",
          cover: "/images/banner.webp",
        };
      </script>
       
    
    
      
        
<script src="/js/insert_highlight.js" data-pjax></script>

        
      
    
    
      <script type="module" data-pjax>
        const PhotoSwipeLightbox = (await safeImport("https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe-lightbox.esm.min.js", "sha384-DiL6M/gG+wmTxmCRZyD1zee6lIhawn5TGvED0FOh7fXcN9B0aZ9dexSF/N6lrZi/")).default;
        
        const pswp = () => {
          if (_$$('.article-entry a.article-gallery-item').length > 0) {
            new PhotoSwipeLightbox({
              gallery: '.article-entry',
              children: 'a.article-gallery-item',
              pswpModule: () => safeImport("https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.esm.min.js", "sha384-WkkO3GCmgkC3VQWpaV8DqhKJqpzpF9JoByxDmnV8+oTJ7m3DfYEWX1fu1scuS4+s")
            }).init();
          }
          if(_$$('.article-gallery a.article-gallery-item').length > 0) {
            new PhotoSwipeLightbox({
              gallery: '.article-gallery',
              children: 'a.article-gallery-item',
              pswpModule: () => safeImport("https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.esm.min.js", "sha384-WkkO3GCmgkC3VQWpaV8DqhKJqpzpF9JoByxDmnV8+oTJ7m3DfYEWX1fu1scuS4+s")
            }).init();
          }
          window.lightboxStatus = 'done';
          window.removeEventListener('lightbox:ready', pswp);
        }
        if(window.lightboxStatus === 'ready') {
          pswp()
        } else {
          window.addEventListener('lightbox:ready', pswp);
        }
      </script>
      








    
  </div>
</div>


  <script>
    console.log(String.raw`%c 
 ______     ______     __     __    __     __  __    
/\  == \   /\  ___\   /\ \   /\ "-./  \   /\ \/\ \   
\ \  __<   \ \  __\   \ \ \  \ \ \-./\ \  \ \ \_\ \  
 \ \_\ \_\  \ \_____\  \ \_\  \ \_\ \ \_\  \ \_____\ 
  \/_/ /_/   \/_____/   \/_/   \/_/  \/_/   \/_____/ 
                                                  
`,'color: #ff5252;')
    console.log('%c Theme.Reimu v' + '1.3.0' + ' %c https://github.com/D-Sketon/hexo-theme-reimu ', 'color: white; background: #ff5252; padding:5px 0;', 'padding:4px;border:1px solid #ff5252;')
  </script>
  



  
<script src="https://npm.webcache.cn/busuanzi@2.3.0/bsz.pure.mini.js" integrity="sha384-0M75wtSkhjIInv4coYlaJU83+OypaRCIq2SukQVQX04eGTCBXJDuWAbJet56id+S" crossorigin="anonymous" async></script>




<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.getRegistrations().then((registrations) => {
      for (let registration of registrations) {
        registration.unregister();
      }
    });
  }
</script>



  
    
<script src="https://npm.webcache.cn/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm&#x2F;Yr2r3Dy4lfFg" crossorigin="anonymous" defer data-pjax></script>

    
<script src="https://npm.webcache.cn/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb&#x2F;GhzOouOXtZMP&#x2F;7XUzwPTstBeZFe&#x2F;+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" defer onload="renderMathInElement(document.body, {delimiters: [{left: &#39;$$&#39;, right: &#39;$$&#39;, display: true},{left: &#39;$&#39;, right: &#39;$&#39;, display: false}]});" data-pjax></script>

  





  </body>
  </html>

